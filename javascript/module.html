<!DOCTYPE html><html lang="cn"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/0b3619e1f688ca46.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0b3619e1f688ca46.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-38cee4c0e358b1a3.js" defer=""></script><script src="/_next/static/chunks/framework-6698976aa0ea586d.js" defer=""></script><script src="/_next/static/chunks/main-9ca4f46f71f15dad.js" defer=""></script><script src="/_next/static/chunks/pages/_app-979b2f9127ab1499.js" defer=""></script><script src="/_next/static/chunks/7a7c95a0-ab903f899792323b.js" defer=""></script><script src="/_next/static/chunks/581-340f217658a3c725.js" defer=""></script><script src="/_next/static/chunks/pages/%5B%5B...id%5D%5D-706fc642a67ce3cd.js" defer=""></script><script src="/_next/static/F5pi5djmx84d7mAaXUDE6/_buildManifest.js" defer=""></script><script src="/_next/static/F5pi5djmx84d7mAaXUDE6/_ssgManifest.js" defer=""></script></head><body class=" bg-light text-light-text dark:bg-dark dark:text-dark-text max-sm:text-sm"><script>
                (function () {
                  function setTheme(newTheme) {
                    window.__theme = newTheme;
                    if (newTheme === 'dark') {
                      document.documentElement.classList.add('dark');
                    } else if (newTheme === 'light') {
                      document.documentElement.classList.remove('dark');
                    }
                  }

                  var preferredTheme;
                  try {
                    preferredTheme = localStorage.getItem('theme');
                  } catch (err) { }

                  window.__setPreferredTheme = function(newTheme) {
                    preferredTheme = newTheme;
                    setTheme(newTheme);
                    try {
                      localStorage.setItem('theme', newTheme);
                    } catch (err) { }
                  };

                  var initialTheme = preferredTheme;
                  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

                  if (!initialTheme) {
                    initialTheme = darkQuery.matches ? 'dark' : 'light';
                  }
                  setTheme(initialTheme);

                  darkQuery.addEventListener('change', function (e) {
                    if (!preferredTheme) {
                      setTheme(e.matches ? 'dark' : 'light');
                    }
                  });
                })();
              </script><div id="__next"><header class="w-full fixed t-0 h-14 border-b backdrop-blur border-slate-900/10 dark:border-slate-300/10 z-10"><div class="w-full h-full flex flex-row items-center justify-between px-4"><div>厘清逻辑</div><div class="mr-2 flex flex-row items-center justify-between gap-2 text-xl"><a href="https://github.com/Xxs-7/Xxs-7.github.io" class="p-1 rounded-full hover:bg-dark/5 hover:dark:bg-light/5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><button class="block dark:hidden p-1 rounded-full hover:bg-dark/5 hover:dark:bg-light/5" type="button" aria-label="Use Dark Mode"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"></path></svg></button><button type="button" class="hidden dark:block p-1 rounded-full hover:bg-dark/5 hover:dark:bg-light/5" aria-label="Use Light Mode"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79zM1 10.5h3v2H1zM11 .55h2V3.5h-2zm8.04 2.495l1.408 1.407-1.79 1.79-1.407-1.408zm-1.8 15.115l1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5h3v2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm-1 4h2v2.95h-2zm-7.45-.96l1.41 1.41 1.79-1.8-1.41-1.41z"></path></svg></button></div></div></header><div class="pt-14 flex max-w-screen overflow-y-scroll"><nav class="hidden lg:block fixed top-14 lg:bottom-0 lg:h-screen w-[18rem] pb-10 pl-4 overflow-y-auto min-h-screen z-10"><nav><ul class="mt-6 mb-12"><!--$--><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">html</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/html/SemanticsTag">语义化标签</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/html/anchor">锚元素</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">css</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/flex">flex 布局</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/grid">grid 布局</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/unit">布局单位</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/stacking-context">层叠上下文</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">javascript</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/javascript/promise">promise</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/javascript/async-await">async 和 await</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/javascript/execution-context">执行上下文</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/javascript/scopes">作用域</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">react</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react/roadmap">学习路线</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react/lifecycle">类组件生命周期</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react/hook">hook</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react/high-compoment">组件逻辑复用方案</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">react 源码</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/architecture">源码架构</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/fiber-node">fiber 节点</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/render-mode">渲染模式</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/execution-context">context</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/scheduler">scheduler</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/first-render">初次渲染</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/update-render">更新渲染</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/render-task">渲染任务的执行</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/reconcile">reconcile</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">实践</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/demo/music-player">音乐播放器</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/demo/font-advance">字体库优化</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">资料</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/material/roadmap">路线图</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">遐想</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/opinion/blog">博客</a></li></ul></li><!--/$--></ul></nav></nav><main class="relative lg:ml-[18rem] min-w-0 flex-1 pl-1 pr-5 pb-6"><article class="mx-auto xl:max-w-none overflow-x-hidden xl:ml-0 xl:mr-[18rem]"><h1 class="mdx-heading text-3xl font-extrabold my-6 text-header dark:text-header-dark" id="模块化">模块化</h1>
<p class="whitespace-pre-wrap my-2 ">目前有多种模块规范：ESModule，CommonJs，AMD，CMD</p>
<p class="whitespace-pre-wrap my-2 ">模块规范的出现解决了项目中代码的划分组织问题，代码复用问题，依赖管理问题，性能问题。</p>
<ol class="ml-6 my-3 list-decimal">
<li class="leading-relaxed ">提高代码的可维护性和可读性：模块化可以将复杂的代码拆分成小的、可管理的部分，使得代码更加清晰和易于维护。每个模块都有一个特定的功能，使得代码更加模块化，易于阅读和理解。</li>
<li class="leading-relaxed ">提高代码的可复用性：通过将代码拆分成模块，可以方便地重用和组合这些模块，从而提高代码的可复用性。</li>
<li class="leading-relaxed ">方便依赖管理：模块化可以帮助你更好地管理项目的依赖关系，使得项目更加清晰和易于维护。例如，使用 npm 或 yarn 等包管理工具可以方便地安装和管理项目的依赖包。</li>
<li class="leading-relaxed ">提高性能：模块化可以优化代码的加载和执行速度。通过将代码拆分成模块，可以实现按需加载和缓存，从而提高性能。</li>
</ol>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="规范">规范<a href="#规范" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<ol class="ml-6 my-3 list-decimal">
<li class="leading-relaxed ">
<p class="whitespace-pre-wrap my-2 ">CommonJs，2009 年随 nodejs 出现。CommonJS 里一个模块就是一个脚本文件，通过 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code> 命令来加载模块，并使用 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">module.exports</code> 暴漏模块的接口。</p>
<p class="whitespace-pre-wrap my-2 ">加载时执行是 CommonJS 模块的重要特性，即脚本代码在 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code> 的时候就会执行模块中的代码。这个特性在服务端是没问题的，但如果引入一个模块就要等待它执行完才能执行后面的代码，这在浏览器端就会有很大的问题了。因此出现了  <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Famdjs%2Famdjs-api%2Fwiki%2FAMD" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">AMD</a> 规范，以支持浏览器环境。
CommonJS模块的重要特性是加载时执行，即脚本代码在<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code>的时候，就会全部执行（同步）。</p>
</li>
<li class="leading-relaxed ">
<p class="whitespace-pre-wrap my-2 ">AMD，在 ESM 出现前，AMD 是可以在项目中用来在浏览器实现模块化的方案。<a href="https://github.com/amdjs/amdjs-api/wiki/AMD" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">AMD</a>是&quot;Asynchronous Module Definition&quot;的缩写，意思就是&quot;异步模块定义&quot;。通过 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require([module], callback);</code> 语句异步加载模块，即模块的加载不影响它后面语句的运行。所有依赖这个模块的语句，都定义在一个回调函数中，等到加载完成之后，这个回调函数才会运行。加载模块不会阻塞代码执行，所以能够在浏览器中使用。</p>
</li>
<li class="leading-relaxed ">
<p class="whitespace-pre-wrap my-2 ">ES module
不同于 CommonJS 和 AMD 的模块加载方案，<a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.ecma-international.org%2Fecma-262%2F6.0%2F" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">ES6</a> 在 JavaScript 语言层面上实现了模块功能。通过 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">import...from...</code>   导入模块，<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">export</code> 导出接口。 它的设计思想是：尽量的静态化，使得编译时就能确定模块的依赖关系。<strong class="font-bold">在遇到模块加载命令 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">import</code> 时，不会去执行模块，而是只生成一个引用。等到真的需要用到时，再到模块里面去取值。</strong></p>
</li>
</ol>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="es-module">ES module<a href="#es-module" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="用法">用法<a href="#用法" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<p class="whitespace-pre-wrap my-2 "><a href="https://www.bookstack.cn/read/es6-3rd/spilt.3.docs-module-loader.md" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">https://www.bookstack.cn/read/es6-3rd/spilt.1.docs-module.md</a></p>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="支持静态代码分析">支持静态代码分析<a href="#支持静态代码分析" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<p class="whitespace-pre-wrap my-2 ">静态代码分析是指在代码运行之前对代码进行分析，以发现潜在的问题和优化代码。这种方式可以提高代码的质量和性能，同时减少运行时的错误。</p>
<p class="whitespace-pre-wrap my-2 ">静态代码分析是由构建工具处理，比如 babel，webpack，rollup。</p>
<p class="whitespace-pre-wrap my-2 ">静态代码分析过程</p>
<ol class="ml-6 my-3 list-decimal">
<li class="leading-relaxed ">**识别模块：**首先需要识别代码中的模块导入和导出语句。ES模块使用 <strong class="font-bold"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">import</code></strong> 和 <strong class="font-bold"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">export</code></strong> 关键字来声明模块间的依赖关系。</li>
<li class="leading-relaxed ">**分析依赖关系：**一旦识别了模块导入语句，静态分析器会分析这些导入语句，并确定模块之间的依赖关系。这些依赖关系描述了一个模块需要从其他模块中导入哪些成员（变量、函数、类等）。</li>
<li class="leading-relaxed ">**解析模块路径：**静态分析器会解析导入语句中指定的模块路径。这可能是相对路径（相对于当前模块文件的路径）或绝对路径（完整的 URL 或文件系统路径）。</li>
<li class="leading-relaxed ">**确定导出内容：**对于每个模块，静态分析器会确定其导出的内容，即哪些成员是可以被其他模块导入的。这些导出的内容可以通过 <strong class="font-bold"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">export</code></strong> 关键字来声明。</li>
<li class="leading-relaxed ">**构建依赖图：**静态分析器会根据分析的依赖关系构建一个模块依赖图（dependency graph）。这个依赖图描述了模块之间的相互依赖关系，可以用来优化模块的加载和执行顺序。</li>
<li class="leading-relaxed ">**检测循环依赖：**静态分析器会检测模块之间是否存在循环依赖关系。循环依赖可能会导致程序运行时的问题，因此静态分析器会提前发现并报告这些问题。</li>
<li class="leading-relaxed ">**优化代码加载：**一旦完成了依赖图的构建，静态分析器可以利用这个信息来优化模块加载的顺序和方式。例如，可以通过并行加载模块和按需加载模块来提高加载性能。</li>
</ol>
<p class="whitespace-pre-wrap my-2 ">在这个静态代码分析过程，构建工具可以进行 tree-shaking，优化代码减少打包产物体积。</p>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="导出值">导出值<a href="#导出值" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<p class="whitespace-pre-wrap my-2 ">ESmodule 可以导出变量或函数。导出方式，默认导出，命名导出，重命名导出，这些基础的内容这里略。</p>
<p class="whitespace-pre-wrap my-2 "><strong class="font-bold">导出的值是引用关系：</strong></p>
<p class="whitespace-pre-wrap my-2 ">导出的值与模块内部的值是引用关系。当一个模块导出一个变量、对象或者函数时，其他模块导入该值后，实际上导入的是对该值的引用（<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">const</code> 类型)，而不是该值的副本。</p>
<p class="whitespace-pre-wrap my-2 ">以下面例子，index.js 不能直接修改从 module1 导入的 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">val</code> 值，直接报语法错误。module1 中修改 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">val</code> 值，index.js 中 val 值随之改变（引用）。</p>
<pre><!--$--><div class="prism-code language-tsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// module1.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> val </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">0</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">add</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  val </span><span class="whitespace-pre-wrap">+=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">1</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">val</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> val</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> add</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> log </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// index.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> val</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> add</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> log </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./module1.js&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 导入值</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">val</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 0</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// error, 导入值不能修改</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// Uncaught TypeError: Assignment to constant variable.</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// val += 1;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 修改 module1 中的 val，本模块导入的 val 值随之改变，</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 即为 module1 的 val 的引用</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">add</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 1</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">val</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 1 </span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="循环依赖问题">循环依赖问题<a href="#循环依赖问题" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<p class="whitespace-pre-wrap my-2 ">A 依赖 B，B 依赖 A，这就造成循环依赖问题。</p>
<p class="whitespace-pre-wrap my-2 ">es6 规范中，并没有明确提出循环依赖的处理。</p>
<p class="whitespace-pre-wrap my-2 ">ESM 模块中的代码在 import 语句执行之前就已经执行了。当浏览器加载一个包含 ES 模块的 JavaScript 文件时，它会立即执行这个文件，并且会执行模块中的所有顶级代码（top-level code，比如变量、函数、类的声明，以及一些代码执行语句），包括模块中的导入和导出语句。</p>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// foo.mjs</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;hello foo&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">foo</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;hello fun&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> foo </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// index.mjs</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;hello index&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> foo </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./foo.mjs&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">foo</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 结果，hello foo 先于  hello index</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// hello foo</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// hello index</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// hello fun</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<p class="whitespace-pre-wrap my-2 ">函数由于有函数声明提升，出现循环依赖时不会出现引用错误。</p>
<p class="whitespace-pre-wrap my-2 ">在 ESM 中，变量出现循环依赖时，会出现引用错误。</p>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// a.mjs</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> val_b </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./b.mjs&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">val_b</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> val_a </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;a 模块的值&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 循环依赖</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// b.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> val_a </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./a.mjs&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// ReferenceError: Cannot access &#x27;val_a&#x27; before initialization</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">val_a</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> val_b </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;b 模块的常量&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<p class="whitespace-pre-wrap my-2 ">具体见：<a href="https://www.bookstack.cn/read/es6-3rd/spilt.4.docs-module-loader.md" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">https://www.bookstack.cn/read/es6-3rd/spilt.4.docs-module-loader.md</a></p>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="commonjs">CommonJS<a href="#commonjs" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="用法">用法<a href="#用法" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<p class="whitespace-pre-wrap my-2 ">CommonJS 模块就是一个脚本文件。<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code>命令第一次加载该脚本，就会执行整个脚本，然后在内存生成一个对象。</p>
<p class="whitespace-pre-wrap my-2 ">以后需要用到这个模块的时候，就会到<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">exports</code>属性上面取值。即使再次执行<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code>命令，也不会再次执行该模块，而是到缓存之中取值。也就是说，CommonJS 模块无论加载多少次，都只会在第一次加载时运行一次，以后再加载，就返回第一次运行的结果，除非手动清除系统缓存。</p>
<p class="whitespace-pre-wrap my-2 ">CommonJs 模块之间的依赖关系，是在运行时确定的，并非通过静态代码分析得到的。</p>
<p class="whitespace-pre-wrap my-2 ">CJS 模块中，存在以下顶层变量（即 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">this</code>，esm 模块顶层 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">this</code> 为 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">undefine</code>：</p>
<ul class="ml-6 my-3 list-disc">
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">arguments</code></li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code></li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">module</code></li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">exports</code></li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">__filename</code></li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">__dirname</code></li>
</ul>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="导出值">导出值<a href="#导出值" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<p class="whitespace-pre-wrap my-2 ">CommonJS的导出值是一份值的拷贝，不是引用。</p>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// a.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> numA </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">0</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">setA</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">num</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  numA </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> num</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">getA</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">numA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">module</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">exports</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  numA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  getA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  setA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// index.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 数据引用问题</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> numA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> getA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> setA </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">require</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./a.js&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;numA&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> numA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 0</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">setA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">100</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">getA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">//100</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 导入的值不变</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;numA&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> numA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 0</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">numA </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">10</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">getA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 100 </span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 修改导入值不影响 a.js 中 numA 的值</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;numA&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> numA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 1</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="循环依赖问题">循环依赖问题<a href="#循环依赖问题" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">CommonJS</p>
<p class="whitespace-pre-wrap my-2 ">第一，加载时执行；第二，已加载的模块会进行缓存，不会重复加载。</p>
<p class="whitespace-pre-wrap my-2 "><strong class="font-bold">一旦出现某个模块被&quot;循环加载&quot;，就只输出已经执行的部分，还未执行的部分不会输出。</strong></p>
<p class="whitespace-pre-wrap my-2 ">在 CommonJS 规范中，当遇到 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require()</code> 语句时，会执行 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require</code> 模块中的代码，并缓存执行的结果，当下次再次加载时不会重复执行，而是直接取缓存的结果。正因为此，出现循环依赖时才不会出现无限循环调用的情况。虽然这种模块加载机制可以避免出现循环依赖时报错的情况，但稍不注意就很可能使得代码并不是像我们想象的那样去执行。</p>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 循环依赖</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// a.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// val</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> b </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">require</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./b.js&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;当前是 a.js 内:&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> b</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// {}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">module</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">exports</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">a</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;在 a.js 内&quot;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 循环依赖</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// b.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// val</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">a </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">require</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./a.js&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;当前是 b.js 内:&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> a</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">module</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">exports</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">b</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;a.js 内&quot;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 执行：node a.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 结果：出现循环依赖，a.js 执行到 require(&quot;./b.js&quot;)，此时模块 a 的 exports 为空</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 当前是 b.js 内: undefined</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 当前是 a.js 内: a.js 内</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// (node:64053) Warning: Accessing non-existent property &#x27;a&#x27; of module exports inside circular dependency</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">Use</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">`</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">node --trace-warnings ...</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">`</span><span class="whitespace-pre-wrap"> to show where the warning was created</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 循环依赖</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// a.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// function</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> funB </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">require</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./b.js&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">funB</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;a 调用 bar&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">funA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">str</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">str</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">module</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">exports</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> funA </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// b.js</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// function</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> funA </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">require</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;./a.js&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">funB</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">str</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap">console</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">log</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">str</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">funA</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;b 调用 a&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">module</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">exports</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> funB </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 结果：报错，此时模块 A 没有函数 funA</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// funA(&quot;b 调用 a&quot;);</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// ^</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// TypeError: funA is not a function</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="cjs-和-esm差别">CJS 和 ESM差别<a href="#cjs-和-esm差别" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<ul class="ml-6 my-3 list-disc">
<li class="leading-relaxed ">CommonJS 模块是运行时加载，ES6 模块是编译时输出接口。</li>
<li class="leading-relaxed ">CommonJS 模块的顶层<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">this</code>指向当前模块。ES6 模块之中，顶层的<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">this</code>指向<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">undefined</code>；</li>
<li class="leading-relaxed ">CommonJS 模块的<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">require()</code>是同步加载模块，ES6 模块的<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">import</code>命令是异步加载，有一个独立的模块依赖的解析阶段。</li>
<li class="leading-relaxed ">CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用。</li>
<li class="leading-relaxed ">CommonJs 会有模块缓存</li>
</ul>
<p class="whitespace-pre-wrap my-2 ">补充</p>
<p class="whitespace-pre-wrap my-2 ">静态代码的好处：</p>
<ol class="ml-6 my-3 list-decimal">
<li class="leading-relaxed ">静态代码分析可以帮助优化代码性能。通过分析代码，可以找出潜在的性能问题，例如不必要的变量声明、不必要的函数调用等。这样可以优化代码的性能，减少不必要的资源消耗。</li>
<li class="leading-relaxed ">静态代码分析可以帮助发现代码中的错误和问题。通过分析代码，可以找出潜在的错误，例如变量未声明、变量未赋值等。这样可以减少运行时的错误，提高代码的稳定性。</li>
<li class="leading-relaxed ">静态代码分析可以帮助提高开发效率。通过分析代码，可以提供代码补全、错误提示等功能，从而提高开发者的效率。</li>
</ol>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="参考资料">参考资料<a href="#参考资料" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 "><a href="https://www.ruanyifeng.com/blog/2012/10/javascript_module.html" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">https://www.ruanyifeng.com/blog/2012/10/javascript_module.html</a></p>
<p class="whitespace-pre-wrap my-2 "><a href="http://calculist.org/blog/2012/06/29/static-module-resolution/" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">http://calculist.org/blog/2012/06/29/static-module-resolution/</a></p></article><aside class="hidden xl:block fixed top-14 right-0 w-[18rem] py-6 overflow-y-auto"><ul class="text-sm font-medium"><li class="pl-2 text-base">模块化</li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#规范" class="block py-1">规范</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#es-module" class="block py-1">ES module</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#用法" class="block py-1">用法</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#支持静态代码分析" class="block py-1">支持静态代码分析</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#导出值" class="block py-1">导出值</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#循环依赖问题" class="block py-1">循环依赖问题</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#commonjs" class="block py-1">CommonJS</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#用法" class="block py-1">用法</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#导出值" class="block py-1">导出值</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#循环依赖问题" class="block py-1">循环依赖问题</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#cjs-和-esm差别" class="block py-1">CJS 和 ESM差别</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#参考资料" class="block py-1">参考资料</a></li></ul></aside></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"toc":[{"text":"模块化","hash":"#模块化","depth":1},{"text":"规范","hash":"#规范","depth":2},{"text":"ES module","hash":"#es-module","depth":2},{"text":"用法","hash":"#用法","depth":3},{"text":"支持静态代码分析","hash":"#支持静态代码分析","depth":3},{"text":"导出值","hash":"#导出值","depth":3},{"text":"循环依赖问题","hash":"#循环依赖问题","depth":3},{"text":"CommonJS","hash":"#commonjs","depth":3},{"text":"用法","hash":"#用法","depth":3},{"text":"导出值","hash":"#导出值","depth":3},{"text":"循环依赖问题","hash":"#循环依赖问题","depth":2},{"text":"CJS 和 ESM差别","hash":"#cjs-和-esm差别","depth":3},{"text":"参考资料","hash":"#参考资料","depth":2}],"code":"var Component=(()=\u003e{var a=Object.create;var c=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var j=(l,n)=\u003e()=\u003e(n||l((n={exports:{}}).exports,n),n.exports),f=(l,n)=\u003e{for(var o in n)c(l,o,{get:n[o],enumerable:!0})},d=(l,n,o,i)=\u003e{if(n\u0026\u0026typeof n==\"object\"||typeof n==\"function\")for(let r of u(n))!g.call(l,r)\u0026\u0026r!==o\u0026\u0026c(l,r,{get:()=\u003en[r],enumerable:!(i=m(n,r))||i.enumerable});return l};var A=(l,n,o)=\u003e(o=l!=null?a(p(l)):{},d(n||!l||!l.__esModule?c(o,\"default\",{value:l,enumerable:!0}):o,l)),x=l=\u003ed(c({},\"__esModule\",{value:!0}),l);var s=j((J,h)=\u003e{h.exports=_jsx_runtime});var v={};f(v,{default:()=\u003ew,frontmatter:()=\u003eb});var e=A(s()),b={title:\"\\u6A21\\u5757\\u5316\",date:\"2024-03-29\",tag:\"module\"};function t(l){let n=Object.assign({h1:\"h1\",p:\"p\",ol:\"ol\",li:\"li\",h2:\"h2\",code:\"code\",a:\"a\",strong:\"strong\",h3:\"h3\",pre:\"pre\",ul:\"ul\"},l.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h1,{hash:\"\\u6A21\\u5757\\u5316\",children:\"\\u6A21\\u5757\\u5316\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u76EE\\u524D\\u6709\\u591A\\u79CD\\u6A21\\u5757\\u89C4\\u8303\\uFF1AESModule\\uFF0CCommonJs\\uFF0CAMD\\uFF0CCMD\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u6A21\\u5757\\u89C4\\u8303\\u7684\\u51FA\\u73B0\\u89E3\\u51B3\\u4E86\\u9879\\u76EE\\u4E2D\\u4EE3\\u7801\\u7684\\u5212\\u5206\\u7EC4\\u7EC7\\u95EE\\u9898\\uFF0C\\u4EE3\\u7801\\u590D\\u7528\\u95EE\\u9898\\uFF0C\\u4F9D\\u8D56\\u7BA1\\u7406\\u95EE\\u9898\\uFF0C\\u6027\\u80FD\\u95EE\\u9898\\u3002\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u63D0\\u9AD8\\u4EE3\\u7801\\u7684\\u53EF\\u7EF4\\u62A4\\u6027\\u548C\\u53EF\\u8BFB\\u6027\\uFF1A\\u6A21\\u5757\\u5316\\u53EF\\u4EE5\\u5C06\\u590D\\u6742\\u7684\\u4EE3\\u7801\\u62C6\\u5206\\u6210\\u5C0F\\u7684\\u3001\\u53EF\\u7BA1\\u7406\\u7684\\u90E8\\u5206\\uFF0C\\u4F7F\\u5F97\\u4EE3\\u7801\\u66F4\\u52A0\\u6E05\\u6670\\u548C\\u6613\\u4E8E\\u7EF4\\u62A4\\u3002\\u6BCF\\u4E2A\\u6A21\\u5757\\u90FD\\u6709\\u4E00\\u4E2A\\u7279\\u5B9A\\u7684\\u529F\\u80FD\\uFF0C\\u4F7F\\u5F97\\u4EE3\\u7801\\u66F4\\u52A0\\u6A21\\u5757\\u5316\\uFF0C\\u6613\\u4E8E\\u9605\\u8BFB\\u548C\\u7406\\u89E3\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u63D0\\u9AD8\\u4EE3\\u7801\\u7684\\u53EF\\u590D\\u7528\\u6027\\uFF1A\\u901A\\u8FC7\\u5C06\\u4EE3\\u7801\\u62C6\\u5206\\u6210\\u6A21\\u5757\\uFF0C\\u53EF\\u4EE5\\u65B9\\u4FBF\\u5730\\u91CD\\u7528\\u548C\\u7EC4\\u5408\\u8FD9\\u4E9B\\u6A21\\u5757\\uFF0C\\u4ECE\\u800C\\u63D0\\u9AD8\\u4EE3\\u7801\\u7684\\u53EF\\u590D\\u7528\\u6027\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u65B9\\u4FBF\\u4F9D\\u8D56\\u7BA1\\u7406\\uFF1A\\u6A21\\u5757\\u5316\\u53EF\\u4EE5\\u5E2E\\u52A9\\u4F60\\u66F4\\u597D\\u5730\\u7BA1\\u7406\\u9879\\u76EE\\u7684\\u4F9D\\u8D56\\u5173\\u7CFB\\uFF0C\\u4F7F\\u5F97\\u9879\\u76EE\\u66F4\\u52A0\\u6E05\\u6670\\u548C\\u6613\\u4E8E\\u7EF4\\u62A4\\u3002\\u4F8B\\u5982\\uFF0C\\u4F7F\\u7528 npm \\u6216 yarn \\u7B49\\u5305\\u7BA1\\u7406\\u5DE5\\u5177\\u53EF\\u4EE5\\u65B9\\u4FBF\\u5730\\u5B89\\u88C5\\u548C\\u7BA1\\u7406\\u9879\\u76EE\\u7684\\u4F9D\\u8D56\\u5305\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u63D0\\u9AD8\\u6027\\u80FD\\uFF1A\\u6A21\\u5757\\u5316\\u53EF\\u4EE5\\u4F18\\u5316\\u4EE3\\u7801\\u7684\\u52A0\\u8F7D\\u548C\\u6267\\u884C\\u901F\\u5EA6\\u3002\\u901A\\u8FC7\\u5C06\\u4EE3\\u7801\\u62C6\\u5206\\u6210\\u6A21\\u5757\\uFF0C\\u53EF\\u4EE5\\u5B9E\\u73B0\\u6309\\u9700\\u52A0\\u8F7D\\u548C\\u7F13\\u5B58\\uFF0C\\u4ECE\\u800C\\u63D0\\u9AD8\\u6027\\u80FD\\u3002\"}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u89C4\\u8303\",children:\"\\u89C4\\u8303\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"CommonJs\\uFF0C2009 \\u5E74\\u968F nodejs \\u51FA\\u73B0\\u3002CommonJS \\u91CC\\u4E00\\u4E2A\\u6A21\\u5757\\u5C31\\u662F\\u4E00\\u4E2A\\u811A\\u672C\\u6587\\u4EF6\\uFF0C\\u901A\\u8FC7 \",(0,e.jsx)(n.code,{children:\"require\"}),\" \\u547D\\u4EE4\\u6765\\u52A0\\u8F7D\\u6A21\\u5757\\uFF0C\\u5E76\\u4F7F\\u7528 \",(0,e.jsx)(n.code,{children:\"module.exports\"}),\" \\u66B4\\u6F0F\\u6A21\\u5757\\u7684\\u63A5\\u53E3\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u52A0\\u8F7D\\u65F6\\u6267\\u884C\\u662F CommonJS \\u6A21\\u5757\\u7684\\u91CD\\u8981\\u7279\\u6027\\uFF0C\\u5373\\u811A\\u672C\\u4EE3\\u7801\\u5728 \",(0,e.jsx)(n.code,{children:\"require\"}),\" \\u7684\\u65F6\\u5019\\u5C31\\u4F1A\\u6267\\u884C\\u6A21\\u5757\\u4E2D\\u7684\\u4EE3\\u7801\\u3002\\u8FD9\\u4E2A\\u7279\\u6027\\u5728\\u670D\\u52A1\\u7AEF\\u662F\\u6CA1\\u95EE\\u9898\\u7684\\uFF0C\\u4F46\\u5982\\u679C\\u5F15\\u5165\\u4E00\\u4E2A\\u6A21\\u5757\\u5C31\\u8981\\u7B49\\u5F85\\u5B83\\u6267\\u884C\\u5B8C\\u624D\\u80FD\\u6267\\u884C\\u540E\\u9762\\u7684\\u4EE3\\u7801\\uFF0C\\u8FD9\\u5728\\u6D4F\\u89C8\\u5668\\u7AEF\\u5C31\\u4F1A\\u6709\\u5F88\\u5927\\u7684\\u95EE\\u9898\\u4E86\\u3002\\u56E0\\u6B64\\u51FA\\u73B0\\u4E86  \",(0,e.jsx)(n.a,{href:\"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Famdjs%2Famdjs-api%2Fwiki%2FAMD\",children:\"AMD\"}),` \\u89C4\\u8303\\uFF0C\\u4EE5\\u652F\\u6301\\u6D4F\\u89C8\\u5668\\u73AF\\u5883\\u3002\nCommonJS\\u6A21\\u5757\\u7684\\u91CD\\u8981\\u7279\\u6027\\u662F\\u52A0\\u8F7D\\u65F6\\u6267\\u884C\\uFF0C\\u5373\\u811A\\u672C\\u4EE3\\u7801\\u5728`,(0,e.jsx)(n.code,{children:\"require\"}),\"\\u7684\\u65F6\\u5019\\uFF0C\\u5C31\\u4F1A\\u5168\\u90E8\\u6267\\u884C\\uFF08\\u540C\\u6B65\\uFF09\\u3002\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"AMD\\uFF0C\\u5728 ESM \\u51FA\\u73B0\\u524D\\uFF0CAMD \\u662F\\u53EF\\u4EE5\\u5728\\u9879\\u76EE\\u4E2D\\u7528\\u6765\\u5728\\u6D4F\\u89C8\\u5668\\u5B9E\\u73B0\\u6A21\\u5757\\u5316\\u7684\\u65B9\\u6848\\u3002\",(0,e.jsx)(n.a,{href:\"https://github.com/amdjs/amdjs-api/wiki/AMD\",children:\"AMD\"}),'\\u662F\"Asynchronous Module Definition\"\\u7684\\u7F29\\u5199\\uFF0C\\u610F\\u601D\\u5C31\\u662F\"\\u5F02\\u6B65\\u6A21\\u5757\\u5B9A\\u4E49\"\\u3002\\u901A\\u8FC7 ',(0,e.jsx)(n.code,{children:\"require([module], callback);\"}),\" \\u8BED\\u53E5\\u5F02\\u6B65\\u52A0\\u8F7D\\u6A21\\u5757\\uFF0C\\u5373\\u6A21\\u5757\\u7684\\u52A0\\u8F7D\\u4E0D\\u5F71\\u54CD\\u5B83\\u540E\\u9762\\u8BED\\u53E5\\u7684\\u8FD0\\u884C\\u3002\\u6240\\u6709\\u4F9D\\u8D56\\u8FD9\\u4E2A\\u6A21\\u5757\\u7684\\u8BED\\u53E5\\uFF0C\\u90FD\\u5B9A\\u4E49\\u5728\\u4E00\\u4E2A\\u56DE\\u8C03\\u51FD\\u6570\\u4E2D\\uFF0C\\u7B49\\u5230\\u52A0\\u8F7D\\u5B8C\\u6210\\u4E4B\\u540E\\uFF0C\\u8FD9\\u4E2A\\u56DE\\u8C03\\u51FD\\u6570\\u624D\\u4F1A\\u8FD0\\u884C\\u3002\\u52A0\\u8F7D\\u6A21\\u5757\\u4E0D\\u4F1A\\u963B\\u585E\\u4EE3\\u7801\\u6267\\u884C\\uFF0C\\u6240\\u4EE5\\u80FD\\u591F\\u5728\\u6D4F\\u89C8\\u5668\\u4E2D\\u4F7F\\u7528\\u3002\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[`ES module\n\\u4E0D\\u540C\\u4E8E CommonJS \\u548C AMD \\u7684\\u6A21\\u5757\\u52A0\\u8F7D\\u65B9\\u6848\\uFF0C`,(0,e.jsx)(n.a,{href:\"https://link.juejin.cn/?target=http%3A%2F%2Fwww.ecma-international.org%2Fecma-262%2F6.0%2F\",children:\"ES6\"}),\" \\u5728 JavaScript \\u8BED\\u8A00\\u5C42\\u9762\\u4E0A\\u5B9E\\u73B0\\u4E86\\u6A21\\u5757\\u529F\\u80FD\\u3002\\u901A\\u8FC7 \",(0,e.jsx)(n.code,{children:\"import...from...\"}),\"   \\u5BFC\\u5165\\u6A21\\u5757\\uFF0C\",(0,e.jsx)(n.code,{children:\"export\"}),\" \\u5BFC\\u51FA\\u63A5\\u53E3\\u3002 \\u5B83\\u7684\\u8BBE\\u8BA1\\u601D\\u60F3\\u662F\\uFF1A\\u5C3D\\u91CF\\u7684\\u9759\\u6001\\u5316\\uFF0C\\u4F7F\\u5F97\\u7F16\\u8BD1\\u65F6\\u5C31\\u80FD\\u786E\\u5B9A\\u6A21\\u5757\\u7684\\u4F9D\\u8D56\\u5173\\u7CFB\\u3002\",(0,e.jsxs)(n.strong,{children:[\"\\u5728\\u9047\\u5230\\u6A21\\u5757\\u52A0\\u8F7D\\u547D\\u4EE4 \",(0,e.jsx)(n.code,{children:\"import\"}),\" \\u65F6\\uFF0C\\u4E0D\\u4F1A\\u53BB\\u6267\\u884C\\u6A21\\u5757\\uFF0C\\u800C\\u662F\\u53EA\\u751F\\u6210\\u4E00\\u4E2A\\u5F15\\u7528\\u3002\\u7B49\\u5230\\u771F\\u7684\\u9700\\u8981\\u7528\\u5230\\u65F6\\uFF0C\\u518D\\u5230\\u6A21\\u5757\\u91CC\\u9762\\u53BB\\u53D6\\u503C\\u3002\"]})]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"es-module\",children:\"ES module\"}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u7528\\u6CD5\",children:\"\\u7528\\u6CD5\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://www.bookstack.cn/read/es6-3rd/spilt.3.docs-module-loader.md\",children:\"https://www.bookstack.cn/read/es6-3rd/spilt.1.docs-module.md\"})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u652F\\u6301\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\",children:\"\\u652F\\u6301\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u662F\\u6307\\u5728\\u4EE3\\u7801\\u8FD0\\u884C\\u4E4B\\u524D\\u5BF9\\u4EE3\\u7801\\u8FDB\\u884C\\u5206\\u6790\\uFF0C\\u4EE5\\u53D1\\u73B0\\u6F5C\\u5728\\u7684\\u95EE\\u9898\\u548C\\u4F18\\u5316\\u4EE3\\u7801\\u3002\\u8FD9\\u79CD\\u65B9\\u5F0F\\u53EF\\u4EE5\\u63D0\\u9AD8\\u4EE3\\u7801\\u7684\\u8D28\\u91CF\\u548C\\u6027\\u80FD\\uFF0C\\u540C\\u65F6\\u51CF\\u5C11\\u8FD0\\u884C\\u65F6\\u7684\\u9519\\u8BEF\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u662F\\u7531\\u6784\\u5EFA\\u5DE5\\u5177\\u5904\\u7406\\uFF0C\\u6BD4\\u5982 babel\\uFF0Cwebpack\\uFF0Crollup\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u8FC7\\u7A0B\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"**\\u8BC6\\u522B\\u6A21\\u5757\\uFF1A**\\u9996\\u5148\\u9700\\u8981\\u8BC6\\u522B\\u4EE3\\u7801\\u4E2D\\u7684\\u6A21\\u5757\\u5BFC\\u5165\\u548C\\u5BFC\\u51FA\\u8BED\\u53E5\\u3002ES\\u6A21\\u5757\\u4F7F\\u7528 \",(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"import\"})}),\" \\u548C \",(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"export\"})}),\" \\u5173\\u952E\\u5B57\\u6765\\u58F0\\u660E\\u6A21\\u5757\\u95F4\\u7684\\u4F9D\\u8D56\\u5173\\u7CFB\\u3002\"]}),`\n`,(0,e.jsx)(n.li,{children:\"**\\u5206\\u6790\\u4F9D\\u8D56\\u5173\\u7CFB\\uFF1A**\\u4E00\\u65E6\\u8BC6\\u522B\\u4E86\\u6A21\\u5757\\u5BFC\\u5165\\u8BED\\u53E5\\uFF0C\\u9759\\u6001\\u5206\\u6790\\u5668\\u4F1A\\u5206\\u6790\\u8FD9\\u4E9B\\u5BFC\\u5165\\u8BED\\u53E5\\uFF0C\\u5E76\\u786E\\u5B9A\\u6A21\\u5757\\u4E4B\\u95F4\\u7684\\u4F9D\\u8D56\\u5173\\u7CFB\\u3002\\u8FD9\\u4E9B\\u4F9D\\u8D56\\u5173\\u7CFB\\u63CF\\u8FF0\\u4E86\\u4E00\\u4E2A\\u6A21\\u5757\\u9700\\u8981\\u4ECE\\u5176\\u4ED6\\u6A21\\u5757\\u4E2D\\u5BFC\\u5165\\u54EA\\u4E9B\\u6210\\u5458\\uFF08\\u53D8\\u91CF\\u3001\\u51FD\\u6570\\u3001\\u7C7B\\u7B49\\uFF09\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"**\\u89E3\\u6790\\u6A21\\u5757\\u8DEF\\u5F84\\uFF1A**\\u9759\\u6001\\u5206\\u6790\\u5668\\u4F1A\\u89E3\\u6790\\u5BFC\\u5165\\u8BED\\u53E5\\u4E2D\\u6307\\u5B9A\\u7684\\u6A21\\u5757\\u8DEF\\u5F84\\u3002\\u8FD9\\u53EF\\u80FD\\u662F\\u76F8\\u5BF9\\u8DEF\\u5F84\\uFF08\\u76F8\\u5BF9\\u4E8E\\u5F53\\u524D\\u6A21\\u5757\\u6587\\u4EF6\\u7684\\u8DEF\\u5F84\\uFF09\\u6216\\u7EDD\\u5BF9\\u8DEF\\u5F84\\uFF08\\u5B8C\\u6574\\u7684 URL \\u6216\\u6587\\u4EF6\\u7CFB\\u7EDF\\u8DEF\\u5F84\\uFF09\\u3002\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"**\\u786E\\u5B9A\\u5BFC\\u51FA\\u5185\\u5BB9\\uFF1A**\\u5BF9\\u4E8E\\u6BCF\\u4E2A\\u6A21\\u5757\\uFF0C\\u9759\\u6001\\u5206\\u6790\\u5668\\u4F1A\\u786E\\u5B9A\\u5176\\u5BFC\\u51FA\\u7684\\u5185\\u5BB9\\uFF0C\\u5373\\u54EA\\u4E9B\\u6210\\u5458\\u662F\\u53EF\\u4EE5\\u88AB\\u5176\\u4ED6\\u6A21\\u5757\\u5BFC\\u5165\\u7684\\u3002\\u8FD9\\u4E9B\\u5BFC\\u51FA\\u7684\\u5185\\u5BB9\\u53EF\\u4EE5\\u901A\\u8FC7 \",(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"export\"})}),\" \\u5173\\u952E\\u5B57\\u6765\\u58F0\\u660E\\u3002\"]}),`\n`,(0,e.jsx)(n.li,{children:\"**\\u6784\\u5EFA\\u4F9D\\u8D56\\u56FE\\uFF1A**\\u9759\\u6001\\u5206\\u6790\\u5668\\u4F1A\\u6839\\u636E\\u5206\\u6790\\u7684\\u4F9D\\u8D56\\u5173\\u7CFB\\u6784\\u5EFA\\u4E00\\u4E2A\\u6A21\\u5757\\u4F9D\\u8D56\\u56FE\\uFF08dependency graph\\uFF09\\u3002\\u8FD9\\u4E2A\\u4F9D\\u8D56\\u56FE\\u63CF\\u8FF0\\u4E86\\u6A21\\u5757\\u4E4B\\u95F4\\u7684\\u76F8\\u4E92\\u4F9D\\u8D56\\u5173\\u7CFB\\uFF0C\\u53EF\\u4EE5\\u7528\\u6765\\u4F18\\u5316\\u6A21\\u5757\\u7684\\u52A0\\u8F7D\\u548C\\u6267\\u884C\\u987A\\u5E8F\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"**\\u68C0\\u6D4B\\u5FAA\\u73AF\\u4F9D\\u8D56\\uFF1A**\\u9759\\u6001\\u5206\\u6790\\u5668\\u4F1A\\u68C0\\u6D4B\\u6A21\\u5757\\u4E4B\\u95F4\\u662F\\u5426\\u5B58\\u5728\\u5FAA\\u73AF\\u4F9D\\u8D56\\u5173\\u7CFB\\u3002\\u5FAA\\u73AF\\u4F9D\\u8D56\\u53EF\\u80FD\\u4F1A\\u5BFC\\u81F4\\u7A0B\\u5E8F\\u8FD0\\u884C\\u65F6\\u7684\\u95EE\\u9898\\uFF0C\\u56E0\\u6B64\\u9759\\u6001\\u5206\\u6790\\u5668\\u4F1A\\u63D0\\u524D\\u53D1\\u73B0\\u5E76\\u62A5\\u544A\\u8FD9\\u4E9B\\u95EE\\u9898\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"**\\u4F18\\u5316\\u4EE3\\u7801\\u52A0\\u8F7D\\uFF1A**\\u4E00\\u65E6\\u5B8C\\u6210\\u4E86\\u4F9D\\u8D56\\u56FE\\u7684\\u6784\\u5EFA\\uFF0C\\u9759\\u6001\\u5206\\u6790\\u5668\\u53EF\\u4EE5\\u5229\\u7528\\u8FD9\\u4E2A\\u4FE1\\u606F\\u6765\\u4F18\\u5316\\u6A21\\u5757\\u52A0\\u8F7D\\u7684\\u987A\\u5E8F\\u548C\\u65B9\\u5F0F\\u3002\\u4F8B\\u5982\\uFF0C\\u53EF\\u4EE5\\u901A\\u8FC7\\u5E76\\u884C\\u52A0\\u8F7D\\u6A21\\u5757\\u548C\\u6309\\u9700\\u52A0\\u8F7D\\u6A21\\u5757\\u6765\\u63D0\\u9AD8\\u52A0\\u8F7D\\u6027\\u80FD\\u3002\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5728\\u8FD9\\u4E2A\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u8FC7\\u7A0B\\uFF0C\\u6784\\u5EFA\\u5DE5\\u5177\\u53EF\\u4EE5\\u8FDB\\u884C tree-shaking\\uFF0C\\u4F18\\u5316\\u4EE3\\u7801\\u51CF\\u5C11\\u6253\\u5305\\u4EA7\\u7269\\u4F53\\u79EF\\u3002\"}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u5BFC\\u51FA\\u503C\",children:\"\\u5BFC\\u51FA\\u503C\"}),`\n`,(0,e.jsx)(n.p,{children:\"ESmodule \\u53EF\\u4EE5\\u5BFC\\u51FA\\u53D8\\u91CF\\u6216\\u51FD\\u6570\\u3002\\u5BFC\\u51FA\\u65B9\\u5F0F\\uFF0C\\u9ED8\\u8BA4\\u5BFC\\u51FA\\uFF0C\\u547D\\u540D\\u5BFC\\u51FA\\uFF0C\\u91CD\\u547D\\u540D\\u5BFC\\u51FA\\uFF0C\\u8FD9\\u4E9B\\u57FA\\u7840\\u7684\\u5185\\u5BB9\\u8FD9\\u91CC\\u7565\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u5BFC\\u51FA\\u7684\\u503C\\u662F\\u5F15\\u7528\\u5173\\u7CFB\\uFF1A\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5BFC\\u51FA\\u7684\\u503C\\u4E0E\\u6A21\\u5757\\u5185\\u90E8\\u7684\\u503C\\u662F\\u5F15\\u7528\\u5173\\u7CFB\\u3002\\u5F53\\u4E00\\u4E2A\\u6A21\\u5757\\u5BFC\\u51FA\\u4E00\\u4E2A\\u53D8\\u91CF\\u3001\\u5BF9\\u8C61\\u6216\\u8005\\u51FD\\u6570\\u65F6\\uFF0C\\u5176\\u4ED6\\u6A21\\u5757\\u5BFC\\u5165\\u8BE5\\u503C\\u540E\\uFF0C\\u5B9E\\u9645\\u4E0A\\u5BFC\\u5165\\u7684\\u662F\\u5BF9\\u8BE5\\u503C\\u7684\\u5F15\\u7528\\uFF08\",(0,e.jsx)(n.code,{children:\"const\"}),\" \\u7C7B\\u578B)\\uFF0C\\u800C\\u4E0D\\u662F\\u8BE5\\u503C\\u7684\\u526F\\u672C\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u4EE5\\u4E0B\\u9762\\u4F8B\\u5B50\\uFF0Cindex.js \\u4E0D\\u80FD\\u76F4\\u63A5\\u4FEE\\u6539\\u4ECE module1 \\u5BFC\\u5165\\u7684 \",(0,e.jsx)(n.code,{children:\"val\"}),\" \\u503C\\uFF0C\\u76F4\\u63A5\\u62A5\\u8BED\\u6CD5\\u9519\\u8BEF\\u3002module1 \\u4E2D\\u4FEE\\u6539 \",(0,e.jsx)(n.code,{children:\"val\"}),\" \\u503C\\uFF0Cindex.js \\u4E2D val \\u503C\\u968F\\u4E4B\\u6539\\u53D8\\uFF08\\u5F15\\u7528\\uFF09\\u3002\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-tsx\",children:`// module1.js\nlet val = 0;\n\nfunction add() {\n  val += 1;\n}\n\nfunction log() {\n  console.log(val);\n}\n\nexport { val, add, log };\n\n// index.js\nimport { val, add, log } from \"./module1.js\";\n\n// \\u5BFC\\u5165\\u503C\nconsole.log(val); // 0\n\n// error, \\u5BFC\\u5165\\u503C\\u4E0D\\u80FD\\u4FEE\\u6539\n// Uncaught TypeError: Assignment to constant variable.\n// val += 1;\n\n// \\u4FEE\\u6539 module1 \\u4E2D\\u7684 val\\uFF0C\\u672C\\u6A21\\u5757\\u5BFC\\u5165\\u7684 val \\u503C\\u968F\\u4E4B\\u6539\\u53D8\\uFF0C\n// \\u5373\\u4E3A module1 \\u7684 val \\u7684\\u5F15\\u7528\nadd();\nlog(); // 1\nconsole.log(val); // 1 \n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u5FAA\\u73AF\\u4F9D\\u8D56\\u95EE\\u9898\",children:\"\\u5FAA\\u73AF\\u4F9D\\u8D56\\u95EE\\u9898\"}),`\n`,(0,e.jsx)(n.p,{children:\"A \\u4F9D\\u8D56 B\\uFF0CB \\u4F9D\\u8D56 A\\uFF0C\\u8FD9\\u5C31\\u9020\\u6210\\u5FAA\\u73AF\\u4F9D\\u8D56\\u95EE\\u9898\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"es6 \\u89C4\\u8303\\u4E2D\\uFF0C\\u5E76\\u6CA1\\u6709\\u660E\\u786E\\u63D0\\u51FA\\u5FAA\\u73AF\\u4F9D\\u8D56\\u7684\\u5904\\u7406\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"ESM \\u6A21\\u5757\\u4E2D\\u7684\\u4EE3\\u7801\\u5728 import \\u8BED\\u53E5\\u6267\\u884C\\u4E4B\\u524D\\u5C31\\u5DF2\\u7ECF\\u6267\\u884C\\u4E86\\u3002\\u5F53\\u6D4F\\u89C8\\u5668\\u52A0\\u8F7D\\u4E00\\u4E2A\\u5305\\u542B ES \\u6A21\\u5757\\u7684 JavaScript \\u6587\\u4EF6\\u65F6\\uFF0C\\u5B83\\u4F1A\\u7ACB\\u5373\\u6267\\u884C\\u8FD9\\u4E2A\\u6587\\u4EF6\\uFF0C\\u5E76\\u4E14\\u4F1A\\u6267\\u884C\\u6A21\\u5757\\u4E2D\\u7684\\u6240\\u6709\\u9876\\u7EA7\\u4EE3\\u7801\\uFF08top-level code\\uFF0C\\u6BD4\\u5982\\u53D8\\u91CF\\u3001\\u51FD\\u6570\\u3001\\u7C7B\\u7684\\u58F0\\u660E\\uFF0C\\u4EE5\\u53CA\\u4E00\\u4E9B\\u4EE3\\u7801\\u6267\\u884C\\u8BED\\u53E5\\uFF09\\uFF0C\\u5305\\u62EC\\u6A21\\u5757\\u4E2D\\u7684\\u5BFC\\u5165\\u548C\\u5BFC\\u51FA\\u8BED\\u53E5\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`// foo.mjs\nconsole.log(\"hello foo\");\n\nconst foo = () =\u003e {\n  console.log(\"hello fun\");\n};\n\nexport { foo };\n\n// index.mjs\nconsole.log(\"hello index\");\nimport { foo } from \"./foo.mjs\";\n\nfoo();\n\n// \\u7ED3\\u679C\\uFF0Chello foo \\u5148\\u4E8E  hello index\n// hello foo\n// hello index\n// hello fun\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u51FD\\u6570\\u7531\\u4E8E\\u6709\\u51FD\\u6570\\u58F0\\u660E\\u63D0\\u5347\\uFF0C\\u51FA\\u73B0\\u5FAA\\u73AF\\u4F9D\\u8D56\\u65F6\\u4E0D\\u4F1A\\u51FA\\u73B0\\u5F15\\u7528\\u9519\\u8BEF\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5728 ESM \\u4E2D\\uFF0C\\u53D8\\u91CF\\u51FA\\u73B0\\u5FAA\\u73AF\\u4F9D\\u8D56\\u65F6\\uFF0C\\u4F1A\\u51FA\\u73B0\\u5F15\\u7528\\u9519\\u8BEF\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`// a.mjs\nimport { val_b } from \"./b.mjs\";\n\nconsole.log(val_b);\n\nexport let val_a = \"a \\u6A21\\u5757\\u7684\\u503C\";\n\n// \\u5FAA\\u73AF\\u4F9D\\u8D56\n// b.js\nimport { val_a } from \"./a.mjs\";\n\n// ReferenceError: Cannot access 'val_a' before initialization\nconsole.log(val_a);\nexport let val_b = \"b \\u6A21\\u5757\\u7684\\u5E38\\u91CF\";\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5177\\u4F53\\u89C1\\uFF1A\",(0,e.jsx)(n.a,{href:\"https://www.bookstack.cn/read/es6-3rd/spilt.4.docs-module-loader.md\",children:\"https://www.bookstack.cn/read/es6-3rd/spilt.4.docs-module-loader.md\"})]}),`\n`,(0,e.jsx)(n.h3,{hash:\"commonjs\",children:\"CommonJS\"}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u7528\\u6CD5\",children:\"\\u7528\\u6CD5\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"CommonJS \\u6A21\\u5757\\u5C31\\u662F\\u4E00\\u4E2A\\u811A\\u672C\\u6587\\u4EF6\\u3002\",(0,e.jsx)(n.code,{children:\"require\"}),\"\\u547D\\u4EE4\\u7B2C\\u4E00\\u6B21\\u52A0\\u8F7D\\u8BE5\\u811A\\u672C\\uFF0C\\u5C31\\u4F1A\\u6267\\u884C\\u6574\\u4E2A\\u811A\\u672C\\uFF0C\\u7136\\u540E\\u5728\\u5185\\u5B58\\u751F\\u6210\\u4E00\\u4E2A\\u5BF9\\u8C61\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u4EE5\\u540E\\u9700\\u8981\\u7528\\u5230\\u8FD9\\u4E2A\\u6A21\\u5757\\u7684\\u65F6\\u5019\\uFF0C\\u5C31\\u4F1A\\u5230\",(0,e.jsx)(n.code,{children:\"exports\"}),\"\\u5C5E\\u6027\\u4E0A\\u9762\\u53D6\\u503C\\u3002\\u5373\\u4F7F\\u518D\\u6B21\\u6267\\u884C\",(0,e.jsx)(n.code,{children:\"require\"}),\"\\u547D\\u4EE4\\uFF0C\\u4E5F\\u4E0D\\u4F1A\\u518D\\u6B21\\u6267\\u884C\\u8BE5\\u6A21\\u5757\\uFF0C\\u800C\\u662F\\u5230\\u7F13\\u5B58\\u4E4B\\u4E2D\\u53D6\\u503C\\u3002\\u4E5F\\u5C31\\u662F\\u8BF4\\uFF0CCommonJS \\u6A21\\u5757\\u65E0\\u8BBA\\u52A0\\u8F7D\\u591A\\u5C11\\u6B21\\uFF0C\\u90FD\\u53EA\\u4F1A\\u5728\\u7B2C\\u4E00\\u6B21\\u52A0\\u8F7D\\u65F6\\u8FD0\\u884C\\u4E00\\u6B21\\uFF0C\\u4EE5\\u540E\\u518D\\u52A0\\u8F7D\\uFF0C\\u5C31\\u8FD4\\u56DE\\u7B2C\\u4E00\\u6B21\\u8FD0\\u884C\\u7684\\u7ED3\\u679C\\uFF0C\\u9664\\u975E\\u624B\\u52A8\\u6E05\\u9664\\u7CFB\\u7EDF\\u7F13\\u5B58\\u3002\"]}),`\n`,(0,e.jsx)(n.p,{children:\"CommonJs \\u6A21\\u5757\\u4E4B\\u95F4\\u7684\\u4F9D\\u8D56\\u5173\\u7CFB\\uFF0C\\u662F\\u5728\\u8FD0\\u884C\\u65F6\\u786E\\u5B9A\\u7684\\uFF0C\\u5E76\\u975E\\u901A\\u8FC7\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u5F97\\u5230\\u7684\\u3002\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"CJS \\u6A21\\u5757\\u4E2D\\uFF0C\\u5B58\\u5728\\u4EE5\\u4E0B\\u9876\\u5C42\\u53D8\\u91CF\\uFF08\\u5373 \",(0,e.jsx)(n.code,{children:\"this\"}),\"\\uFF0Cesm \\u6A21\\u5757\\u9876\\u5C42 \",(0,e.jsx)(n.code,{children:\"this\"}),\" \\u4E3A \",(0,e.jsx)(n.code,{children:\"undefine\"}),\"\\uFF1A\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.code,{children:\"arguments\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.code,{children:\"require\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.code,{children:\"module\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.code,{children:\"exports\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.code,{children:\"__filename\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.code,{children:\"__dirname\"})}),`\n`]}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u5BFC\\u51FA\\u503C\",children:\"\\u5BFC\\u51FA\\u503C\"}),`\n`,(0,e.jsx)(n.p,{children:\"CommonJS\\u7684\\u5BFC\\u51FA\\u503C\\u662F\\u4E00\\u4EFD\\u503C\\u7684\\u62F7\\u8D1D\\uFF0C\\u4E0D\\u662F\\u5F15\\u7528\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`// a.js\nlet numA = 0;\nlet setA = function (num) {\n  numA = num;\n};\n\nlet getA = function () {\n  console.log(numA);\n};\n\nmodule.exports = {\n  numA,\n  getA,\n  setA,\n};\n\n// index.js\n// \\u6570\\u636E\\u5F15\\u7528\\u95EE\\u9898\nlet { numA, getA, setA } = require(\"./a.js\");\n\nconsole.log(\"numA\", numA); // 0\n\nsetA(100); \ngetA(); //100\n\n// \\u5BFC\\u5165\\u7684\\u503C\\u4E0D\\u53D8\nconsole.log(\"numA\", numA); // 0\n\nnumA = 10;\ngetA(); // 100 \n// \\u4FEE\\u6539\\u5BFC\\u5165\\u503C\\u4E0D\\u5F71\\u54CD a.js \\u4E2D numA \\u7684\\u503C\nconsole.log(\"numA\", numA); // 1\n`})}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u5FAA\\u73AF\\u4F9D\\u8D56\\u95EE\\u9898\",children:\"\\u5FAA\\u73AF\\u4F9D\\u8D56\\u95EE\\u9898\"}),`\n`,(0,e.jsx)(n.p,{children:\"CommonJS\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u7B2C\\u4E00\\uFF0C\\u52A0\\u8F7D\\u65F6\\u6267\\u884C\\uFF1B\\u7B2C\\u4E8C\\uFF0C\\u5DF2\\u52A0\\u8F7D\\u7684\\u6A21\\u5757\\u4F1A\\u8FDB\\u884C\\u7F13\\u5B58\\uFF0C\\u4E0D\\u4F1A\\u91CD\\u590D\\u52A0\\u8F7D\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:'\\u4E00\\u65E6\\u51FA\\u73B0\\u67D0\\u4E2A\\u6A21\\u5757\\u88AB\"\\u5FAA\\u73AF\\u52A0\\u8F7D\"\\uFF0C\\u5C31\\u53EA\\u8F93\\u51FA\\u5DF2\\u7ECF\\u6267\\u884C\\u7684\\u90E8\\u5206\\uFF0C\\u8FD8\\u672A\\u6267\\u884C\\u7684\\u90E8\\u5206\\u4E0D\\u4F1A\\u8F93\\u51FA\\u3002'})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5728 CommonJS \\u89C4\\u8303\\u4E2D\\uFF0C\\u5F53\\u9047\\u5230 \",(0,e.jsx)(n.code,{children:\"require()\"}),\" \\u8BED\\u53E5\\u65F6\\uFF0C\\u4F1A\\u6267\\u884C \",(0,e.jsx)(n.code,{children:\"require\"}),\" \\u6A21\\u5757\\u4E2D\\u7684\\u4EE3\\u7801\\uFF0C\\u5E76\\u7F13\\u5B58\\u6267\\u884C\\u7684\\u7ED3\\u679C\\uFF0C\\u5F53\\u4E0B\\u6B21\\u518D\\u6B21\\u52A0\\u8F7D\\u65F6\\u4E0D\\u4F1A\\u91CD\\u590D\\u6267\\u884C\\uFF0C\\u800C\\u662F\\u76F4\\u63A5\\u53D6\\u7F13\\u5B58\\u7684\\u7ED3\\u679C\\u3002\\u6B63\\u56E0\\u4E3A\\u6B64\\uFF0C\\u51FA\\u73B0\\u5FAA\\u73AF\\u4F9D\\u8D56\\u65F6\\u624D\\u4E0D\\u4F1A\\u51FA\\u73B0\\u65E0\\u9650\\u5FAA\\u73AF\\u8C03\\u7528\\u7684\\u60C5\\u51B5\\u3002\\u867D\\u7136\\u8FD9\\u79CD\\u6A21\\u5757\\u52A0\\u8F7D\\u673A\\u5236\\u53EF\\u4EE5\\u907F\\u514D\\u51FA\\u73B0\\u5FAA\\u73AF\\u4F9D\\u8D56\\u65F6\\u62A5\\u9519\\u7684\\u60C5\\u51B5\\uFF0C\\u4F46\\u7A0D\\u4E0D\\u6CE8\\u610F\\u5C31\\u5F88\\u53EF\\u80FD\\u4F7F\\u5F97\\u4EE3\\u7801\\u5E76\\u4E0D\\u662F\\u50CF\\u6211\\u4EEC\\u60F3\\u8C61\\u7684\\u90A3\\u6837\\u53BB\\u6267\\u884C\\u3002\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`// \\u5FAA\\u73AF\\u4F9D\\u8D56\n// a.js\n\n// val\nconst { b } = require(\"./b.js\");\nconsole.log(\"\\u5F53\\u524D\\u662F a.js \\u5185:\", b); // {}\nmodule.exports = { a: \"\\u5728 a.js \\u5185\" };\n\n// \\u5FAA\\u73AF\\u4F9D\\u8D56\n// b.js\n\n// val\nconst {a } = require(\"./a.js\");\nconsole.log(\"\\u5F53\\u524D\\u662F b.js \\u5185:\", a);\nmodule.exports = { b: \"a.js \\u5185\" };\n\n// \\u6267\\u884C\\uFF1Anode a.js\n// \\u7ED3\\u679C\\uFF1A\\u51FA\\u73B0\\u5FAA\\u73AF\\u4F9D\\u8D56\\uFF0Ca.js \\u6267\\u884C\\u5230 require(\"./b.js\")\\uFF0C\\u6B64\\u65F6\\u6A21\\u5757 a \\u7684 exports \\u4E3A\\u7A7A\n// \\u5F53\\u524D\\u662F b.js \\u5185: undefined\n// \\u5F53\\u524D\\u662F a.js \\u5185: a.js \\u5185\n// (node:64053) Warning: Accessing non-existent property 'a' of module exports inside circular dependency\n(Use \\`node --trace-warnings ...\\` to show where the warning was created)\n`})}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`// \\u5FAA\\u73AF\\u4F9D\\u8D56\n// a.js\n// function\nconst { funB } = require(\"./b.js\");\n\nfunB(\"a \\u8C03\\u7528 bar\");\n\nfunction funA(str) {\n  console.log(str);\n}\nmodule.exports = { funA };\n\n// b.js\n// function\nconst { funA } = require(\"./a.js\");\nfunction funB(str) {\n  console.log(str);\n}\nfunA(\"b \\u8C03\\u7528 a\");\n\nmodule.exports = { funB };\n\n// \\u7ED3\\u679C\\uFF1A\\u62A5\\u9519\\uFF0C\\u6B64\\u65F6\\u6A21\\u5757 A \\u6CA1\\u6709\\u51FD\\u6570 funA\n// funA(\"b \\u8C03\\u7528 a\");\n// ^\n// TypeError: funA is not a function\n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"cjs-\\u548C-esm\\u5DEE\\u522B\",children:\"CJS \\u548C ESM\\u5DEE\\u522B\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"CommonJS \\u6A21\\u5757\\u662F\\u8FD0\\u884C\\u65F6\\u52A0\\u8F7D\\uFF0CES6 \\u6A21\\u5757\\u662F\\u7F16\\u8BD1\\u65F6\\u8F93\\u51FA\\u63A5\\u53E3\\u3002\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"CommonJS \\u6A21\\u5757\\u7684\\u9876\\u5C42\",(0,e.jsx)(n.code,{children:\"this\"}),\"\\u6307\\u5411\\u5F53\\u524D\\u6A21\\u5757\\u3002ES6 \\u6A21\\u5757\\u4E4B\\u4E2D\\uFF0C\\u9876\\u5C42\\u7684\",(0,e.jsx)(n.code,{children:\"this\"}),\"\\u6307\\u5411\",(0,e.jsx)(n.code,{children:\"undefined\"}),\"\\uFF1B\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"CommonJS \\u6A21\\u5757\\u7684\",(0,e.jsx)(n.code,{children:\"require()\"}),\"\\u662F\\u540C\\u6B65\\u52A0\\u8F7D\\u6A21\\u5757\\uFF0CES6 \\u6A21\\u5757\\u7684\",(0,e.jsx)(n.code,{children:\"import\"}),\"\\u547D\\u4EE4\\u662F\\u5F02\\u6B65\\u52A0\\u8F7D\\uFF0C\\u6709\\u4E00\\u4E2A\\u72EC\\u7ACB\\u7684\\u6A21\\u5757\\u4F9D\\u8D56\\u7684\\u89E3\\u6790\\u9636\\u6BB5\\u3002\"]}),`\n`,(0,e.jsx)(n.li,{children:\"CommonJS \\u6A21\\u5757\\u8F93\\u51FA\\u7684\\u662F\\u4E00\\u4E2A\\u503C\\u7684\\u62F7\\u8D1D\\uFF0CES6 \\u6A21\\u5757\\u8F93\\u51FA\\u7684\\u662F\\u503C\\u7684\\u5F15\\u7528\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"CommonJs \\u4F1A\\u6709\\u6A21\\u5757\\u7F13\\u5B58\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u8865\\u5145\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u7684\\u597D\\u5904\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u53EF\\u4EE5\\u5E2E\\u52A9\\u4F18\\u5316\\u4EE3\\u7801\\u6027\\u80FD\\u3002\\u901A\\u8FC7\\u5206\\u6790\\u4EE3\\u7801\\uFF0C\\u53EF\\u4EE5\\u627E\\u51FA\\u6F5C\\u5728\\u7684\\u6027\\u80FD\\u95EE\\u9898\\uFF0C\\u4F8B\\u5982\\u4E0D\\u5FC5\\u8981\\u7684\\u53D8\\u91CF\\u58F0\\u660E\\u3001\\u4E0D\\u5FC5\\u8981\\u7684\\u51FD\\u6570\\u8C03\\u7528\\u7B49\\u3002\\u8FD9\\u6837\\u53EF\\u4EE5\\u4F18\\u5316\\u4EE3\\u7801\\u7684\\u6027\\u80FD\\uFF0C\\u51CF\\u5C11\\u4E0D\\u5FC5\\u8981\\u7684\\u8D44\\u6E90\\u6D88\\u8017\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u53EF\\u4EE5\\u5E2E\\u52A9\\u53D1\\u73B0\\u4EE3\\u7801\\u4E2D\\u7684\\u9519\\u8BEF\\u548C\\u95EE\\u9898\\u3002\\u901A\\u8FC7\\u5206\\u6790\\u4EE3\\u7801\\uFF0C\\u53EF\\u4EE5\\u627E\\u51FA\\u6F5C\\u5728\\u7684\\u9519\\u8BEF\\uFF0C\\u4F8B\\u5982\\u53D8\\u91CF\\u672A\\u58F0\\u660E\\u3001\\u53D8\\u91CF\\u672A\\u8D4B\\u503C\\u7B49\\u3002\\u8FD9\\u6837\\u53EF\\u4EE5\\u51CF\\u5C11\\u8FD0\\u884C\\u65F6\\u7684\\u9519\\u8BEF\\uFF0C\\u63D0\\u9AD8\\u4EE3\\u7801\\u7684\\u7A33\\u5B9A\\u6027\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u9759\\u6001\\u4EE3\\u7801\\u5206\\u6790\\u53EF\\u4EE5\\u5E2E\\u52A9\\u63D0\\u9AD8\\u5F00\\u53D1\\u6548\\u7387\\u3002\\u901A\\u8FC7\\u5206\\u6790\\u4EE3\\u7801\\uFF0C\\u53EF\\u4EE5\\u63D0\\u4F9B\\u4EE3\\u7801\\u8865\\u5168\\u3001\\u9519\\u8BEF\\u63D0\\u793A\\u7B49\\u529F\\u80FD\\uFF0C\\u4ECE\\u800C\\u63D0\\u9AD8\\u5F00\\u53D1\\u8005\\u7684\\u6548\\u7387\\u3002\"}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u53C2\\u8003\\u8D44\\u6599\",children:\"\\u53C2\\u8003\\u8D44\\u6599\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://www.ruanyifeng.com/blog/2012/10/javascript_module.html\",children:\"https://www.ruanyifeng.com/blog/2012/10/javascript_module.html\"})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"http://calculist.org/blog/2012/06/29/static-module-resolution/\",children:\"http://calculist.org/blog/2012/06/29/static-module-resolution/\"})})]})}function S(l={}){let{wrapper:n}=l.components||{};return n?(0,e.jsx)(n,Object.assign({},l,{children:(0,e.jsx)(t,l)})):t(l)}var w=S;return x(v);})();\n;return Component;"},"__N_SSG":true},"page":"/[[...id]]","query":{"id":["javascript","module"]},"buildId":"F5pi5djmx84d7mAaXUDE6","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>