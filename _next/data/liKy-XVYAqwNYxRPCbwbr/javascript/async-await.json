{"pageProps":{"toc":[{"text":"async 和 await","hash":"#async-和-await","depth":1},{"text":"基本用法","hash":"#基本用法","depth":2},{"text":"分析几例执行顺序","hash":"#分析几例执行顺序","depth":3},{"text":"对于多个promise同时执行","hash":"#对于多个promise同时执行","depth":3},{"text":"Promise.all","hash":"#promiseall","depth":3},{"text":"使用await","hash":"#使用await","depth":3},{"text":"await 在遍历中的有效性","hash":"#await-在遍历中的有效性","depth":3},{"text":"异步的传染性","hash":"#异步的传染性","depth":3},{"text":"参考资料","hash":"#参考资料","depth":2}],"code":"var Component=(()=>{var d=Object.create;var t=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var f=(s,n)=>()=>(n||s((n={exports:{}}).exports,n),n.exports),y=(s,n)=>{for(var o in n)t(s,o,{get:n[o],enumerable:!0})},r=(s,n,o,l)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let a of g(n))!p.call(s,a)&&a!==o&&t(s,a,{get:()=>n[a],enumerable:!(l=m(n,a))||l.enumerable});return s};var w=(s,n,o)=>(o=s!=null?d(u(s)):{},r(n||!s||!s.__esModule?t(o,\"default\",{value:s,enumerable:!0}):o,s)),x=s=>r(t({},\"__esModule\",{value:!0}),s);var i=f((D,c)=>{c.exports=_jsx_runtime});var N={};y(N,{default:()=>P});var e=w(i());function h(s){let n=Object.assign({h1:\"h1\",p:\"p\",code:\"code\",h2:\"h2\",pre:\"pre\",h3:\"h3\",ul:\"ul\",li:\"li\",a:\"a\"},s.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h1,{hash:\"async-\\u548C-await\",children:\"async \\u548C await\"}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"async\"}),\"\\u548C \",(0,e.jsx)(n.code,{children:\"await\"}),\"\\u5173\\u952E\\u5B57\\u662F ES6 \\u63D0\\u4F9B\\u7684\\u8BED\\u6CD5\\u7CD6\\uFF0C\\u6765\\u5199\\u51FA\\u57FA\\u4E8EPromise\\u7684\\u5F02\\u6B65\\u884C\\u4E3A\\u7684\\u4E00\\u79CD\\u66F4\\u7B80\\u6D01\\u65B9\\u5F0F\\uFF0C\\u5C06\\u5F02\\u6B65\\u4EE3\\u7801\\u7528\\u540C\\u6B65\\u4EE3\\u7801\\u7684\\u65B9\\u5F0F\\u4E66\\u5199\\u3002\"]}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u57FA\\u672C\\u7528\\u6CD5\",children:\"\\u57FA\\u672C\\u7528\\u6CD5\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function guess(myNum) {\n  return new Promise((resolve, reject) => {\n    let num = parseInt(Math.random() * 6 + 1);\n    if (num === myNum) {\n      resolve(num);\n    } else {\n      reject(num);\n    }\n  });\n}\nasync function test() {\n  try {\n    let n = await guess(3);\n    console.log(\"\\u8D62\\uFF1A\" + n);\n  } catch (e) {\n    console.log(\"\\u8F93\\uFF1A\" + e);\n  }\n}\ntest();\n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u5206\\u6790\\u51E0\\u4F8B\\u6267\\u884C\\u987A\\u5E8F\",children:\"\\u5206\\u6790\\u51E0\\u4F8B\\u6267\\u884C\\u987A\\u5E8F\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`function test1() {\n  console.log(\"444\");\n  return \"555\";\n}\nasync function test2() {\n  console.log(\"111\");\n  let res = await test1();\n  console.log(\"222\");\n  console.log(res);\n}\ntest2();\nconsole.log(\"333\");\n\n// \\u8F93\\u51FA\\u7ED3\\u679C\n// 111\n// 444\n// 333\n// 222\n// 555\n`})}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`async function test1() {\n  console.log(\"444\")\n  return \"555\"\n}\n\nasync function test2() {\n  console.log(\"111\")\n  let res = await test1()\n  console.log(\"222\") \n  console.log(res)\n  return \"888\"\n}\n\nasync function test3() {\n  console.log(\"666\")\n  let res = await test2() \n  console.log(\"777\")\n  console.log(res)\n}\n\ntest3()\nconsole.log(\"333\")\n\n//\\u8F93\\u51FA\\u7ED3\\u679C\n// 666\n// 111\n// 444\n// 333\n// 222\n// 555\n// 777\n// 888\n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u5BF9\\u4E8E\\u591A\\u4E2Apromise\\u540C\\u65F6\\u6267\\u884C\",children:\"\\u5BF9\\u4E8E\\u591A\\u4E2Apromise\\u540C\\u65F6\\u6267\\u884C\"}),`\n`,(0,e.jsx)(n.h3,{hash:\"promiseall\",children:(0,e.jsx)(n.code,{children:\"Promise.all\"})}),`\n`,(0,e.jsx)(n.p,{children:\"promise.all\\u91CC\\u9762\\u8DDF\\u4E00\\u4E2A\\u6570\\u7EC4\\uFF0C\\u6570\\u7EC4\\u7684\\u6BCF\\u4E00\\u9879\\u662F\\u4E00\\u4E2A\\u8FD4\\u56DEpromise\\u7684\\u51FD\\u6570\\u8C03\\u7528\\uFF0Cthen\\u7684\\u7B2C\\u4E00\\u4E2A\\u53C2\\u6570\\u662F\\u6240\\u6709\\u7684promise\\u90FD\\u6210\\u529F\\u540E\\u8C03\\u7528\\uFF0C\\u62FF\\u5230\\u6240\\u6709promise\\u7684\\u7ED3\\u679C\\u662F\\u4E00\\u4E2A\\u6570\\u7EC4\\uFF1B\\u7B2C\\u4E8C\\u4E2A\\u53C2\\u6570\\u62FF\\u5230\\u7684\\u662F\\u7B2C\\u4E00\\u4E2A\\u5931\\u8D25\\u7684\\u503C\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`Promise.all([guess(1), guess(2)]).then(\n  (x) => {\n    console.log(x);\n  },\n  (y) => {\n    console.log(y);\n  }\n);\n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u4F7F\\u7528await\",children:\"\\u4F7F\\u7528await\"}),`\n`,(0,e.jsx)(n.p,{children:\"await\\u662F\\u76F4\\u63A5\\u83B7\\u53D6\\u591A\\u4E2Apromise\\u7684\\u7ED3\\u679C\\u7684\\uFF0C\\u56E0\\u4E3APromise.all()\\u8FD4\\u56DE\\u7684\\u4E5F\\u662F\\u4E00\\u4E2Apromise\\u6240\\u4EE5\\u5982\\u679C\\u8981\\u4F7F\\u7528await\\u62FF\\u5230\\u591A\\u4E2Apromise\\u7684\\u503C\\uFF0C\\u53EF\\u4EE5\\u76F4\\u63A5await Promise.all()\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`async function test(){\n    try{\n        let n = await Promise.all([guess(1),guess(2)])\n        console.log(n)\n    }catch(error){\n        console.log(error)\n    }\n}\ntest()Promise.all([guess(1), guess(2)]).then(\n  (x) => {\n    console.log(x);\n  },\n  (y) => {\n    console.log(y);\n  }\n);\n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"await-\\u5728\\u904D\\u5386\\u4E2D\\u7684\\u6709\\u6548\\u6027\",children:\"await \\u5728\\u904D\\u5386\\u4E2D\\u7684\\u6709\\u6548\\u6027\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u5B9E\\u9645\\u5F00\\u53D1\\u4E2Dfor\\u3001while\\u3001for in\\u3001for of\\u3001for await of\\u4F7F\\u7528await\\u90FD\\u662F\\u751F\\u6548\\u7684\\uFF1B\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u800C\\u51E0\\u4E4E\\u6709\\u56DE\\u8C03\\u7684\\u904D\\u5386\\u65B9\\u6CD5\\uFF1AforEach\\u3001map\\u3001filter\\u3001reduce\\u3001some\\u3001every\\u3001find\\u7B49\\uFF0C\\u4F7F\\u7528await\\u90FD\\u662F\\u4E0D\\u751F\\u6548\\u7684\\uFF1B\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"for await of\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`//\\u6A21\\u62DF\\u5F02\\u6B65\\u4EE3\\u7801\nfunction getDatas(times){\n    times = times || 0\n    return new Promise((resolve, reject)=>{\n        setTimeout(()=>{\n            resolve(times)\n        }, times*1000)\n    })\n}\nlet arrays = [getDatas(0), getDatas(1), getDatas(1.5)]\n//\\u4E00\\u5B9A\\u8981\\u5728async\\u65B9\\u6CD5\\u91CC\\u4F7F\\u7528\\uFF0C\\u4E0D\\u80FD\\u76F4\\u63A5\\u5199for await (let item of arrays){}\\u6267\\u884C\nasync function execute(){\n    for await (let item of arrays){\n        console.log(item)\n    }\n}\nexecute()\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"forEach\\uFF1A\\u4E0D\\u4F1A\\u7B49\\u5F85\\u6BCF\\u4E00\\u6B65\\u7684 promise \\u6267\\u884C\\u5B8C\\u6BD5\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`//\\u6A21\\u62DF\\u5F02\\u6B65\\u4EE3\\u7801\nfunction getDatas(times){\n    times = times || 0\n    return new Promise((resolve, reject)=>{\n        setTimeout(()=>{\n            resolve(times)\n        }, times*1000)\n    })\n}\nlet arrays = [1, 2, 3]\narrays.forEach(async (item, index)=>{\n    console.log(\\`\\u7B2C\\${index+1}\\u6B21\\u5F00\\u59CB\\`)\n    let datas = await getDatas(item)\n    console.log(\"\\u8FD4\\u56DE\\u7ED3\\u679C\\uFF1A\"+datas)\n    console.log(\\`\\u7B2C\\${item}\\u6B21\\u7ED3\\u675F\\`)\n})\n`})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u5F02\\u6B65\\u7684\\u4F20\\u67D3\\u6027\",children:\"\\u5F02\\u6B65\\u7684\\u4F20\\u67D3\\u6027\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5728 \",(0,e.jsx)(n.code,{children:\"async\"}),\" \\u4E2D\\uFF1A\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5982\\u679C\\u4E32\\u884C\\u6267\\u884C\\u591A\\u4E2A\\u542B\\u6709 promise \\u7684\\u51FD\\u6570\\uFF0C\\u5E76\\u4E14\\u4E4B\\u95F4\\u5B58\\u5728\\u4F9D\\u8D56\\uFF0C\\u5373\\u4E0A\\u4E00\\u4E2A\\u51FD\\u6570\\u7ED3\\u679C\\u662F\\u4E0B\\u4E00\\u4E2A promise \\u7684\\u53C2\\u6570\\uFF0C\\u90A3\\u4E48\\u6240\\u6709 promise \\u7684\\u5C01\\u88C5\\u51FD\\u6570\\u5FC5\\u987B\\u90FD\\u5199\\u4E0A \",(0,e.jsx)(n.code,{children:\"async\"}),\" \\u548C \",(0,e.jsx)(n.code,{children:\"await\"})]}),`\n`,(0,e.jsx)(n.li,{children:\"\\u5982\\u679C\\u4E00\\u4E2A\\u5E95\\u5C42\\u51FD\\u6570\\u4F7F\\u7528\\u4E86 async\\uFF0C\\u90A3\\u4E48\\u6240\\u6709\\u57FA\\u4E8E\\u5B83\\u7684\\u6240\\u6709\\u8C03\\u7528\\u94FE\\u90FD\\u5FC5\\u987B\\u4F7F\\u7528 await \\u83B7\\u53D6\\u7ED3\\u679C\\uFF0C\\u6216\\u8005\\u4F7F\\u7528 .then()\\u3002\"}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u53C2\\u8003\\u8D44\\u6599\",children:\"\\u53C2\\u8003\\u8D44\\u6599\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://zh.javascript.info/async-await\",children:\"async/await\"})})]})}function j(s={}){let{wrapper:n}=s.components||{};return n?(0,e.jsx)(n,Object.assign({},s,{children:(0,e.jsx)(h,s)})):h(s)}var P=j;return x(N);})();\n;return Component;"},"__N_SSG":true}