{"pageProps":{"toc":[{"text":"Reconciler","hash":"#reconciler","depth":1},{"text":"virtual dom","hash":"#virtual-dom","depth":2},{"text":"为什么 virtual dom 能提升性能","hash":"#为什么-virtual-dom-能提升性能","depth":2},{"text":"dom diff","hash":"#dom-diff","depth":2},{"text":"diff 的几种策略","hash":"#diff-的几种策略","depth":2},{"text":"Tree diff","hash":"#tree-diff","depth":3},{"text":"Component diff","hash":"#component-diff","depth":3},{"text":"Element diff","hash":"#element-diff","depth":3},{"text":"同层级节点的 diff 过程","hash":"#同层级节点的-diff-过程","depth":2}],"code":"var Component=(()=>{var f=Object.create;var c=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var s=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var v=(d,n)=>()=>(n||d((n={exports:{}}).exports,n),n.exports),C=(d,n)=>{for(var i in n)c(d,i,{get:n[i],enumerable:!0})},h=(d,n,i,r)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let l of s(n))!u.call(d,l)&&l!==i&&c(d,l,{get:()=>n[l],enumerable:!(r=a(n,l))||r.enumerable});return d};var x=(d,n,i)=>(i=d!=null?f(p(d)):{},h(n||!d||!d.__esModule?c(i,\"default\",{value:d,enumerable:!0}):i,d)),b=d=>h(c({},\"__esModule\",{value:!0}),d);var t=v((O,o)=>{o.exports=_jsx_runtime});var j={};C(j,{default:()=>M});var e=x(t());function m(d){let n=Object.assign({h1:\"h1\",blockquote:\"blockquote\",p:\"p\",h2:\"h2\",ol:\"ol\",li:\"li\",code:\"code\",ul:\"ul\",h3:\"h3\",strong:\"strong\"},d.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h1,{hash:\"reconciler\",children:\"Reconciler\"}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u524D\\u7AEF\\u6846\\u67B6\\u7684\\u6E32\\u67D3\\u6307\\u7684\\u662F\\u5C06\\u6570\\u636E\\u548C\\u6A21\\u7248\\u62FC\\u63A5\\u5230\\u4E00\\u8D77\\u5448\\u73B0\\u5230\\u9875\\u9762\\u4E0A\\u3002\"}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"virtual-dom\",children:\"virtual dom\"}),`\n`,(0,e.jsx)(n.p,{children:`Virtual DOM \\u662F\\u771F\\u5B9E dom \\u7684\\u5185\\u5B58\\u865A\\u62DF\\u8868\\u793A\\u3002\\u672C\\u8D28\\u662F javascript \\u5BF9\\u8C61\\uFF0C\\u63CF\\u8FF0\\u4E86\\u771F\\u5B9E DOM \\u7684\\u4FE1\\u606F\\u548C\\u7ED3\\u6784\\u3002\n\\u5176\\u7528\\u5904\\u662F\\u5728\\u9700\\u8981\\u66F4\\u65B0\\u9875\\u9762\\u5185\\u5BB9\\u65F6\\uFF0C\\u901A\\u8FC7\\u5148\\u4FEE\\u6539 virtual dom \\u5BF9\\u8C61\\uFF0C\\u901A\\u8FC7 dom diff \\u7B97\\u6CD5\\u8BA1\\u7B97\\u65B0\\u65E7 virtual dom \\u4E4B\\u95F4\\u7684\\u5DEE\\u5F02\\uFF0C\\u6700\\u540E\\u6839\\u636E\\u5DEE\\u5F02\\u66F4\\u65B0\\u771F\\u5B9E dom\\u3002`}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u4E3A\\u4EC0\\u4E48-virtual-dom-\\u80FD\\u63D0\\u5347\\u6027\\u80FD\",children:\"\\u4E3A\\u4EC0\\u4E48 virtual dom \\u80FD\\u63D0\\u5347\\u6027\\u80FD\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"vitual dom \\u76F8\\u5F53\\u4E8E js \\u548C\\u771F\\u5B9E dom \\u4E4B\\u95F4\\u589E\\u52A0\\u4E86\\u4E00\\u5C42\\u7F13\\u5B58\\uFF0C\\u907F\\u514D\\u4E86\\u6CA1\\u6709\\u5FC5\\u8981\\u7684 dom \\u64CD\\u4F5C\"}),`\n`,(0,e.jsx)(n.li,{children:\"vitual dom \\u5230\\u771F\\u5B9E dom \\u7684\\u66F4\\u65B0\\u662F\\u6279\\u5904\\u7406\\uFF0C\\u901A\\u8FC7\\u51CF\\u5C11\\u9891\\u7E41\\u64CD\\u4F5C dom \\u6765\\u63D0\\u5347\\u6027\\u80FD\\u3002\"}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"dom-diff\",children:\"dom diff\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5F53\\u7EC4\\u4EF6\\u53D1\\u751F\\u53D8\\u66F4\\uFF0C\\u5F62\\u6210\\u4E00\\u68F5\\u65B0\\u7684 vitual dom\\uFF0C\\u5C31\\u4F1A\\u4F7F\\u7528\",(0,e.jsx)(n.code,{children:\"diff\"}),\"\\u7B97\\u6CD5\\u5BF9\\u65B0\\u65E7\\u4E24\\u68F5\\u6811\\u8FDB\\u884C\\u5BF9\\u6BD4\\uFF0C\\u6839\\u636E\\u5BF9\\u6BD4\\u7ED3\\u679C\\u4FEE\\u6539\\u66F4\\u65B0\\u771F\\u5B9E\",(0,e.jsx)(n.code,{children:\"DOM\"}),\"\\u3002\"]}),`\n`,(0,e.jsx)(n.h2,{hash:\"diff-\\u7684\\u51E0\\u79CD\\u7B56\\u7565\",children:\"diff \\u7684\\u51E0\\u79CD\\u7B56\\u7565\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"Web UI\"}),\"\\u4E2D\",(0,e.jsx)(n.code,{children:\"DOM\"}),\"\\u8282\\u70B9\\u8DE8\\u5C42\\u7EA7\\u7684\\u79FB\\u52A8\\u64CD\\u4F5C\\u7279\\u522B\\u5C11\\uFF0C\\u53EF\\u4EE5\\u5FFD\\u7565\\u4E0D\\u8BA1\\u3002\"]}),`\n`,(0,e.jsx)(n.li,{children:\"\\u62E5\\u6709\\u76F8\\u540C\\u7C7B\\u578B\\u7684\\u4E24\\u4E2A\\u7EC4\\u4EF6\\u5C06\\u4F1A\\u751F\\u6210\\u76F8\\u4F3C\\u7684\\u6811\\u5F62\\u7ED3\\u6784\\uFF0C\\u62E5\\u6709\\u4E0D\\u540C\\u7C7B\\u578B\\u7684\\u4E24\\u4E2A\\u7EC4\\u4EF6\\u5C06\\u4F1A\\u751F\\u6210\\u4E0D\\u540C\\u7684\\u6811\\u5F62\\u7ED3\\u6784\\u3002\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5BF9\\u4E8E\\u540C\\u4E00\\u5C42\\u7EA7\\u7684\\u4E00\\u7EC4\\u5B50\\u8282\\u70B9\\uFF0C\\u5B83\\u4EEC\\u53EF\\u4EE5\\u901A\\u8FC7\\u552F\\u4E00\",(0,e.jsx)(n.code,{children:\"id\"}),\"\\u8FDB\\u884C\\u533A\\u5206\"]}),`\n`]}),`\n`,(0,e.jsx)(n.h3,{hash:\"tree-diff\",children:\"Tree diff\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u57FA\\u4E8E\\u7B2C\\u4E00\\u4E2A\\u7B56\\u7565\\uFF0C\",(0,e.jsx)(n.code,{children:\"react\"}),\"\\u53EA\\u4F1A\\u5BF9\\u540C\\u4E00\\u5C42\\u6B21\\u7684\\u8282\\u70B9\\u8FDB\\u884C\\u6BD4\\u8F83\\uFF0C\\u5F53\\u53D1\\u73B0\\u8282\\u70B9\\u4E0D\\u5B58\\u5728\\u65F6\\uFF0C\\u5C31\\u4F1A\\u5220\\u9664\\u6574\\u4E2A\\u8282\\u70B9\\u53CA\\u5176\\u5B50\\u8282\\u70B9\\uFF0C\\u4E0D\\u4F1A\\u518D\\u8FDB\\u884C\\u6BD4\\u8F83\\uFF0C\\u8FD9\\u6837\\u5C31\\u53EA\\u9700\\u8981\\u904D\\u5386\\u4E00\\u6B21\\uFF0C\\u5C31\\u80FD\\u5B8C\\u6210\\u5BF9\\u6574\\u4E2A\",(0,e.jsx)(n.code,{children:\"DOM\"}),\"\\u6811\\u7684\\u6BD4\\u8F83\\u3002\\u4E5F\\u5C31\\u662F\\u53EA\\u8003\\u8651\\u521B\\u5EFA\\u5220\\u9664\\u64CD\\u4F5C\\uFF0C\\u4E0D\\u8003\\u8651\\u53D8\\u66F4\\u4F4D\\u7F6E\\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{hash:\"component-diff\",children:\"Component diff\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u5982\\u679C\\u662F\\u540C\\u4E00\\u7C7B\\u578B\\u7684\\u7EC4\\u4EF6\\uFF0C\\u6309\\u7167\\u539F\\u7B56\\u7565\\u7EE7\\u7EED\\u6BD4\\u8F83\\u865A\\u62DF dom \\u6811\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5982\\u679C\\u4E0D\\u662F\\uFF0C\\u5219\\u5C06\\u8BE5\\u7EC4\\u4EF6\\u5224\\u65AD\\u4E3A\",(0,e.jsx)(n.code,{children:\"dirty component\"}),\"\\uFF0C\\u4ECE\\u800C\\u66FF\\u6362\\u6574\\u4E2A\\u7EC4\\u4EF6\\u4E0B\\u7684\\u6240\\u6709\\u5B50\\u8282\\u70B9\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5BF9\\u4E8E\\u540C\\u4E00\\u7C7B\\u578B\\u7684\\u7EC4\\u4EF6\\uFF0C\\u6709\\u53EF\\u80FD\\u5176\",(0,e.jsx)(n.code,{children:\"Virtual DOM\"}),\"\\u6CA1\\u6709\\u4EFB\\u4F55\\u53D8\\u5316\\uFF0C\\u5982\\u679C\\u80FD\\u591F\\u786E\\u5207\\u7684\\u77E5\\u9053\\u8FD9\\u70B9\\u90A3\\u53EF\\u4EE5\\u8282\\u7701\\u5927\\u91CF\\u7684\",(0,e.jsx)(n.code,{children:\"diff\"}),\"\\u8FD0\\u7B97\\u7684\\u65F6\\u95F4\\uFF0C\\u56E0\\u6B64\",(0,e.jsx)(n.code,{children:\"React\"}),\"\\u5141\\u8BB8\\u7528\\u6237\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"shouldComponentUpdate()\"}),\"\\u5224\\u65AD\\u8BE5\\u7EC4\\u4EF6\\u662F\\u5426\\u9700\\u8981\\u8FDB\\u884C\",(0,e.jsx)(n.code,{children:\"diff\"})]}),`\n`]}),`\n`,(0,e.jsx)(n.h3,{hash:\"element-diff\",children:\"Element diff\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5F53\\u8282\\u70B9\\u5904\\u4E8E\\u540C\\u4E00\\u5C42\\u7EA7\\u65F6\\uFF0C\",(0,e.jsx)(n.code,{children:\"React diff\"}),\"\\u63D0\\u4F9B\\u4E86\\u4E09\\u79CD\\u8282\\u70B9\\u64CD\\u4F5C\\uFF1A\\u63D2\\u5165\\u3001\\u79FB\\u52A8\\u548C\\u5220\\u9664\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"\\u63D2\\u5165\\uFF1A\\u65B0\\u7684\",(0,e.jsx)(n.code,{children:\"component\"}),\"\\u7C7B\\u578B\\u4E0D\\u5728\\u8001\\u96C6\\u5408\\u91CC -> \\u5168\\u65B0\\u7684\\u8282\\u70B9\\uFF0C\\u9700\\u8981\\u5BF9\\u65B0\\u8282\\u70B9\\u6267\\u884C\\u63D2\\u5165\\u64CD\\u4F5C\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"\\u79FB\\u52A8\\uFF1A\\u5728\\u8001\\u96C6\\u5408\\u91CC\\u6709\\u65B0\",(0,e.jsx)(n.code,{children:\"component\"}),\"\\u7C7B\\u578B\\uFF0C\\u4E14\",(0,e.jsx)(n.code,{children:\"element\"}),\"\\u662F\\u53EF\\u66F4\\u65B0\\u7684\\u7C7B\\u578B\\uFF0C\",(0,e.jsx)(n.code,{children:\"generateComponentChildren\"}),\"\\u5DF2\\u8C03\\u7528\",(0,e.jsx)(n.code,{children:\"receiveComponent\"}),\"\\uFF0C\\u8FD9\\u79CD\\u60C5\\u51B5\\u4E0B\",(0,e.jsx)(n.code,{children:\"prevChild=nextChild\"}),\"\\uFF0C\\u5C31\\u9700\\u8981\\u505A\\u79FB\\u52A8\\u64CD\\u4F5C\\uFF0C\\u53EF\\u4EE5\\u590D\\u7528\\u4EE5\\u524D\\u7684\",(0,e.jsx)(n.code,{children:\"dom\"}),\"\\u8282\\u70B9\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"\\u5220\\u9664\\uFF1A\\u8001\\u7684\",(0,e.jsx)(n.code,{children:\"component\"}),\"\\u7C7B\\u578B\\uFF0C\\u5728\\u65B0\\u96C6\\u5408\\u4E2D\\u4E5F\\u6709\\uFF0C\\u4F46\\u5BF9\\u5E94\\u7684\",(0,e.jsx)(n.code,{children:\"element\"}),\"\\u4E0D\\u540C\\u5219\\u4E0D\\u80FD\\u76F4\\u63A5\\u590D\\u7528\\u548C\\u66F4\\u65B0\\uFF0C\\u9700\\u8981\\u6267\\u884C\\u5220\\u9664\\u64CD\\u4F5C\\uFF0C\\u6216\\u8005\\u8001\",(0,e.jsx)(n.code,{children:\"component\"}),\"\\u4E0D\\u5728\\u65B0\\u96C6\\u5408\\u91CC\\uFF0C\\u4E5F\\u9700\\u8981\\u6267\\u884C\\u5220\\u9664\\u64CD\\u4F5C\"]}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u540C\\u5C42\\u7EA7\\u8282\\u70B9\\u7684-diff-\\u8FC7\\u7A0B\",children:\"\\u540C\\u5C42\\u7EA7\\u8282\\u70B9\\u7684 diff \\u8FC7\\u7A0B\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u9996\\u5148\\u660E\\u786E\\u4E0B\\u6570\\u636E\\u7ED3\\u6784\\uFF1A\\u65B0 vdom \\u662F\\u6570\\u7EC4\\uFF0C\\u5373 newChildren\\uFF1B\\u8001 vdom \\u662F fiber \\u5355\\u94FE\\u8868\\uFF0C\\u5373 oldFiber\\u3002\"})}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u65B0\\u8001 VDOM \\u90FD\\u662F\\u4ECE\\u5DE6\\u8FB9\\u5F00\\u59CB\\u904D\\u5386\\u7684\\uFF0C\\u6309\\u4F4D\\u7F6E\\u6BD4\\u8F83\\uFF0C\\u5373\\u7B2C i \\u4E2A\\u8001 vdom \\u548C\\u7B2C i \\u4E2A\\u65B0 vdom \\u6BD4\\u8F83\\uFF0C\\u5982\\u679C\\u8282\\u70B9\\u53EF\\u4EE5\\u590D\\u7528\\uFF0C\\u90A3\\u4E48\\u5148\\u590D\\u7528\\uFF0C\\u7136\\u540E\\u65B0\\u8001 vdom \\u90FD\\u5F80\\u540E\\u79FB\\u4E00\\u4F4D\\uFF0C\\u5426\\u5219\\u5C31\\u4E2D\\u6B62\\u672C\\u8F6E\\u5FAA\\u73AF\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u7ECF\\u8FC7 step1\\uFF0C\\u65B0\\u8282\\u70B9\\u5DF2\\u7ECF\\u904D\\u5386\\u5B8C\\u4E86\\uFF0C\\u90A3\\u4E48\\u5982\\u679C\\u8FD8\\u6709\\u5269\\u4E0B\\u7684\\u8001\\u8282\\u70B9\\uFF0C\\u5220\\u9664\\u5373\\u53EF\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u7ECF\\u8FC7 step1\\uFF0C\\u8001\\u8282\\u70B9\\u6CA1\\u4E86\\uFF0C\\u65B0\\u8282\\u70B9\\u8FD8\\u6709\\uFF0C\\u90A3\\u4E48\\u65B0\\u8282\\u70B9\\u9010\\u4E2A\\u65B0\\u589E\\u5373\\u53EF\\u3002\\u521D\\u6B21\\u6E32\\u67D3\\u8D70\\u7684\\u5C31\\u662F\\u8FD9\\u91CC\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u8D70\\u5230\\u73B0\\u5728\\uFF0C\\u65B0\\u8001\\u8282\\u70B9\\u90FD\\u8FD8\\u6709\\uFF0C\\u4F46\\u662F\\u662F\\u4E71\\u5E8F\\u7684\\u3002\\u56E0\\u6B64\\u53EF\\u4EE5\\u628A oldFiber \\u5355\\u94FE\\u8868\\u505A\\u6210 Map\\uFF0C\\u5373 existingChildren\\uFF0C\\u63A5\\u4E0B\\u6765\\u904D\\u5386 newChildren\\uFF0C\\u627E\\u5230\\u80FD\\u590D\\u7528\\u7684 fiber\\uFF0C\\u5C31\\u590D\\u7528\\u5E76\\u4E14\\u4ECE existingChildren \\u5220\\u9664\\u8FD9\\u4E2A fiber\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u7ECF\\u5386\\u8FC7 step4 \\u4E4B\\u540E\\uFF0C\\u53D1\\u73B0\\u8001\\u8282\\u70B9 existingChildren \\u4E2D\\u8FD8\\u6709\\u6CA1\\u88AB\\u590D\\u7528\\u7684\\uFF0C\\u5168\\u90E8\\u5220\\u9664\\u5373\\u53EF\\u3002\"}),`\n`]}),`\n`]})]})}function g(d={}){let{wrapper:n}=d.components||{};return n?(0,e.jsx)(n,Object.assign({},d,{children:(0,e.jsx)(m,d)})):m(d)}var M=g;return b(j);})();\n;return Component;"},"__N_SSG":true}