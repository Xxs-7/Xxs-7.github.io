<!DOCTYPE html><html lang="cn"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/28746ebb45a12272.css" as="style"/><link rel="stylesheet" href="/_next/static/css/28746ebb45a12272.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-38cee4c0e358b1a3.js" defer=""></script><script src="/_next/static/chunks/framework-6698976aa0ea586d.js" defer=""></script><script src="/_next/static/chunks/main-9ca4f46f71f15dad.js" defer=""></script><script src="/_next/static/chunks/pages/_app-986721e49ce0186e.js" defer=""></script><script src="/_next/static/chunks/7a7c95a0-ab903f899792323b.js" defer=""></script><script src="/_next/static/chunks/581-340f217658a3c725.js" defer=""></script><script src="/_next/static/chunks/pages/%5B%5B...id%5D%5D-706fc642a67ce3cd.js" defer=""></script><script src="/_next/static/tm4WpqTZk4RfqfoaAvJmO/_buildManifest.js" defer=""></script><script src="/_next/static/tm4WpqTZk4RfqfoaAvJmO/_ssgManifest.js" defer=""></script></head><body class=" bg-light text-light-text dark:bg-dark dark:text-dark-text max-sm:text-sm"><script>
                (function () {
                  function setTheme(newTheme) {
                    window.__theme = newTheme;
                    if (newTheme === 'dark') {
                      document.documentElement.classList.add('dark');
                    } else if (newTheme === 'light') {
                      document.documentElement.classList.remove('dark');
                    }
                  }

                  var preferredTheme;
                  try {
                    preferredTheme = localStorage.getItem('theme');
                  } catch (err) { }

                  window.__setPreferredTheme = function(newTheme) {
                    preferredTheme = newTheme;
                    setTheme(newTheme);
                    try {
                      localStorage.setItem('theme', newTheme);
                    } catch (err) { }
                  };

                  var initialTheme = preferredTheme;
                  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

                  if (!initialTheme) {
                    initialTheme = darkQuery.matches ? 'dark' : 'light';
                  }
                  setTheme(initialTheme);

                  darkQuery.addEventListener('change', function (e) {
                    if (!preferredTheme) {
                      setTheme(e.matches ? 'dark' : 'light');
                    }
                  });
                })();
              </script><div id="__next"><header class="w-full fixed t-0 h-14 border-b backdrop-blur border-slate-900/10 dark:border-slate-300/10 z-10"><div class="w-full h-full flex flex-row items-center justify-between px-4"><div>厘清逻辑</div><div class="mr-2 flex flex-row items-center justify-between gap-2 text-xl"><a href="https://github.com/Xxs-7/Xxs-7.github.io" class="p-1 rounded-full hover:bg-dark/5 hover:dark:bg-light/5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><button class="block dark:hidden p-1 rounded-full hover:bg-dark/5 hover:dark:bg-light/5" type="button" aria-label="Use Dark Mode"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"></path></svg></button><button type="button" class="hidden dark:block p-1 rounded-full hover:bg-dark/5 hover:dark:bg-light/5" aria-label="Use Light Mode"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79zM1 10.5h3v2H1zM11 .55h2V3.5h-2zm8.04 2.495l1.408 1.407-1.79 1.79-1.407-1.408zm-1.8 15.115l1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5h3v2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm-1 4h2v2.95h-2zm-7.45-.96l1.41 1.41 1.79-1.8-1.41-1.41z"></path></svg></button></div></div></header><div class="pt-14 flex max-w-screen overflow-y-scroll"><nav class="hidden lg:block fixed top-14 lg:bottom-0 lg:h-screen w-[18rem] pb-10 px-4 overflow-y-auto min-h-screen z-10"><nav><ul class="mt-6"><!--$--><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">html</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/html/SemanticsTag">语义化标签</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/html/anchor">锚元素</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">css</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/flex">flex 布局</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/grid">grid 布局</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/css/unit">布局单位</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">react</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react/lifecycle">lifecycle</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5 text-highlight"><a class="block" href="/react/hook">hook</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react/high-compoment">组件逻辑复用方案</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">react 源码</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/architecture">源码架构</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/fiber-node">fiber 节点</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/render-mode">渲染模式</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/scheduler">scheduler</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/first-render">初次渲染</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/update-render">更新渲染</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/render-task">渲染任务的执行</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/react-src/execution-context">执行上下文</a></li></ul></li><li class="mt-1"><div class="pl-1 border border-transparent rounded-sm font-bold text-lg">实践</div><ul><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/demo/music-player">音乐播放器</a></li><li class="pl-4 border border-transparent rounded-sm font-bold hover:bg-dark/5 text-sm py-0.5 hover:dark:bg-light/5"><a class="block" href="/demo/font-advance">字体库优化</a></li></ul></li><!--/$--></ul></nav></nav><main class="relative lg:ml-[18rem] min-w-0 flex-1 px-5 "><article class="mx-auto xl:max-w-none overflow-x-hidden xl:ml-0 xl:mr-[18rem]"><h1 class="mdx-heading text-3xl font-extrabold my-6 text-header dark:text-header-dark" id="hook">hook</h1>
<p class="whitespace-pre-wrap my-2 ">Hook 是 React 16.8 的新增特性，使得函数组件也能像类组件使用 props 和 state 等特性。</p>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="为什么引入-hook">为什么引入 hook<a href="#为什么引入-hook" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">解决长时间使用和维护 react 过程中遇到的问题：</p>
<ul class="ml-6 my-3 list-disc">
<li class="leading-relaxed ">难以重用和共享组件中的与状态相关的逻辑；</li>
<li class="leading-relaxed ">逻辑复杂的组件变得难以开发和维护，当我们的组件需要处理个不相关的多个 local state 时，每个生命周期函数中可能包含各种互不相关的逻辑在里面</li>
<li class="leading-relaxed ">类组件的 this 增加学习成本，类组件在基于现有工具上的优化存在存在些许问题</li>
<li class="leading-relaxed ">由于业务改动，函数组件不得不改变为类组件等</li>
</ul>
<p class="whitespace-pre-wrap my-2 ">因此，现在的函数组件也可以是有状态的组件，内部也可以维护自身的状态以及做一些逻辑方面的处理。</p>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usestate"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useState</code><a href="#usestate" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">为什么不要在循环、条件判断或者子函数中调用 useState?</p>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="useeffect"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useEffect</code><a href="#useeffect" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useEffect</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 组件渲染后执行</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// 组件卸载后执行</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">[</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">]</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<p class="whitespace-pre-wrap my-2 "><strong class="font-bold"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useEffect</code> 和 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useLayoutEffect</code> 的区别</strong></p>
<ul class="ml-6 my-3 list-disc">
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useEffect</code> 是在 react <strong class="font-bold">完成组件渲染之后</strong>， <strong class="font-bold">异步执行</strong> 的，</li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useLayoutEffect</code> 是在 react 把 <strong class="font-bold">组件（更新）真正渲染到界面之前</strong>，<strong class="font-bold">同步执行</strong>的。和 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">componentDidMount</code> 等价。</li>
</ul>
<p class="whitespace-pre-wrap my-2 "><strong class="font-bold"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useInsertionEffect</code></strong></p>
<p class="whitespace-pre-wrap my-2 "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useInsertionEffect</code> 执行时机比 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useLayoutEffect</code> 还前</p>
<p class="whitespace-pre-wrap my-2 ">本质上 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useInsertionEffect</code> 主要是解决 CSS-in-JS 在渲染中注入样式的性能问题。这个 hooks 主要是应用于这个场景，在其他场景下 React 不期望用这个 hooks 。</p>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="依赖项">依赖项<a href="#依赖项" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<ul class="ml-6 my-3 list-disc">
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap"> </code> 空值：不传递依赖项数组将在每次 DOM 更新时运行回调。</li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">[]</code>: 首次渲染时执行，后续更新不执行</li>
<li class="leading-relaxed "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">[dep1, dep2,...]</code>: 依赖项浅比较，新旧不一致时执行。</li>
</ul>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="useref"><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useRef</code><a href="#useref" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<h3 class="mdx-heading text-xl font-semibold whitespace-pre-wrap mt-4 mb-2 group text-header dark:text-header-dark" id="用法">用法<a href="#用法" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h3>
<ol class="ml-6 my-3 list-decimal">
<li class="leading-relaxed ">保存真实 dom 节点的引用</li>
</ol>
<p class="whitespace-pre-wrap my-2 ">通过<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">ref.current</code>属性访问这个 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">ref</code>的当前变量，这个变量是有意设置为可变的。</p>
<p class="whitespace-pre-wrap my-2 ">为什么只要把<code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">ref</code>挂到某个react元素上，就可以拿到它的dom？
源码是如何将 dom 节点挂到 ref.current 上的？</p>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">TextInputWithFocusButton</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> inputEl </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useRef</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">onButtonClick</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// `current` 指向已挂载到 DOM 上的文本输入元素</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    inputEl</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">current</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">focus</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">input ref</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">inputEl</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> type</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;text&quot;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">button onClick</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">onButtonClick</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap">Focus</span><span class="whitespace-pre-wrap"> the input</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">button</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div></div><!--/$--></pre>
<p class="whitespace-pre-wrap my-2 ">2.存变量</p>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">Timer</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> intervalRef </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useRef</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useEffect</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> id </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">setInterval</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// ...</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    intervalRef</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">current</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> id</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">clearInterval</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">intervalRef</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">current</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// ...</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<p class="whitespace-pre-wrap my-2 ">如果将 current 显示到组件上，只变更 current 的值不会触发重新渲染，即 current 被修改了值，显示的内容依然会是旧数据。只在触发重新渲染（state,prop变更)时被组件显示内容才会被刷新。</p>
<p class="whitespace-pre-wrap my-2 "><code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">createRef</code> 和 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useRef</code></p>
<p class="whitespace-pre-wrap my-2 "><strong class="font-bold">createRef 每次渲染都会返回一个新的引用，而 useRef 每次都会返回相同的引用。</strong></p>
<p class="whitespace-pre-wrap my-2 ">createRef 可以在类组件中使用，useRef 只能在函数组件中使用。</p>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usecontext">useContext<a href="#usecontext" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">用于跨组件（父子孙）传值的一种方式。
嵌套使用 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">useContext</code>，查找 key 值的方式应该是就近原则：</p>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">React</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> createContext</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> useContext </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;react&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> context </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">createContext</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">index</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">h3</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap">Context</span><span class="whitespace-pre-wrap"> test</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">h3</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">context</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">Provider</span><span class="whitespace-pre-wrap"> value</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">value</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">1</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">Child1</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">context</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">Provider</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">Child1</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> value </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useContext</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">context</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">child1</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">value</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">Child2</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">Child2</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">context</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">Provider</span><span class="whitespace-pre-wrap"> value</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">value</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">3</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">Child3</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">context</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">Provider</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">Child3</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> value </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useContext</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">context</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap">child3</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">value</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// Context test</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// child1:1</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// child3:3</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div></div><!--/$--></pre>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usememo">useMemo<a href="#usememo" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">缓存需要经过大量计算的值，避免变量作为 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">prop</code> 时重新赋值导致子组件发生多余的重新渲染</p>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usecallback">useCallback<a href="#usecallback" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">缓存函数地址，避免函数作为 <code class="inline text-code text-secondary dark:text-secondary-dark px-1.5 py-0.5 mx-0.5 rounded-md no-underline bg-[#f2ecde] dark:bg-[#2b333e] text-highlight whitespace-pre-wrap">prop</code> 时重新赋值导致子组件发生多余的重新渲染</p>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usetransition">useTransition<a href="#usetransition" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">react 18 把 update 分为两种类型</p>
<ul class="ml-6 my-3 list-disc">
<li class="leading-relaxed "><strong class="font-bold">Urgent updates</strong> 紧急更新，指直接交互，通常指的用户交互。如点击、输入等。这种更新一旦不及时，用户就会觉得哪里不对。</li>
<li class="leading-relaxed "><strong class="font-bold">Transition updates</strong> 过渡更新，如UI从一个视图向另一个视图的更新。通常这种更新用户并不着急看到。</li>
</ul>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">TransitionPage</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">[</span><span class="whitespace-pre-wrap">isPending</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> setStartTransition</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">]</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useTransition</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">h3</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap">TransitionPage</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">h3</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">button</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        disabled</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">isPending</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        onClick</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">setStartTransition</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">setresource</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">fetchData</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        click</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">button</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usedeferredvalue">useDeferredValue<a href="#usedeferredvalue" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">延迟更新 UI 的某些部分。</p>
<p class="whitespace-pre-wrap my-2 ">使用 query 的组件更新优先渲染，使用 deferredQuery 的组件更新延迟渲染</p>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> useState</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> useDeferredValue </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;react&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">SearchPage</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">[</span><span class="whitespace-pre-wrap">query</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> setQuery</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">]</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useState</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> deferredQuery </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useDeferredValue</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">query</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// ...</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<p class="whitespace-pre-wrap my-2 ">结合 suspend 组件</p>
<pre><!--$--><div class="prism-code language-jsx rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">Suspense</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> useState</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> useDeferredValue </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;react&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">SearchResults</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;./SearchResults.js&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">App</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">[</span><span class="whitespace-pre-wrap">query</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> setQuery</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">]</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useState</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> deferredQuery </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useDeferredValue</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">query</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// isStale 表示当前显示的内容是否过时</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> isStale </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> query </span><span class="whitespace-pre-wrap">!==</span><span class="whitespace-pre-wrap"> deferredQuery</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">label</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        Search albums:</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">input</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(241, 250, 140)">value</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">query</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(241, 250, 140)">onChange</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">e</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">=&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">setQuery</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">e</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">target</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">value</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">/&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;/</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">label</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">Suspense</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(241, 250, 140)">fallback</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">h2</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">Loading...</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;/</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">h2</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">div</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(241, 250, 140)">style</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">          </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">opacity</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">:</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> isStale </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">?</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">0.5</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">:</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">1</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">          </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">transition</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">:</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> isStale </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">?</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;opacity 0.2s 0.2s linear&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">:</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&#x27;opacity 0s 0s linear&#x27;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">        </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">          </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">SearchResults</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(241, 250, 140)">query</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">deferredQuery</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">/&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;/</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">div</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;/</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">Suspense</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&lt;/</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="usesyncexternalstorepage">useSyncExternalStorePage<a href="#usesyncexternalstorepage" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<p class="whitespace-pre-wrap my-2 ">订阅外部数据源（store、事件）</p>
<ol class="ml-6 my-3 list-decimal">
<li class="leading-relaxed ">监听网络在线</li>
</ol>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">subscrbe</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">callback</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">window</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">addEventListener</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;online&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> callback</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">window</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">addEventListener</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;offline&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> callback</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">window</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">removeEventListener</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;online&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> callback</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">window</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">removeEventListener</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;offline&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> callback</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useOnlineStatus</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useSyncExternalStore</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    subscrbe</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">navigator</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">onLine</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">true</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">UseSyncExternalStorePage</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> isOnline </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useOnlineStatus</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(98, 114, 164)">// console.log(&quot;isOnline&quot;, isOnline);</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap">isOnline</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">isOnline</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">toString</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div></div><!--/$--></pre>
<ol class="ml-6 my-3 list-decimal" start="2">
<li class="leading-relaxed ">监听路由变更</li>
</ol>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useHistorySelector</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">selector</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> history </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useHistory</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useSyncExternalStore</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">history</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">listen</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">selector</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">history</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<ol class="ml-6 my-3 list-decimal" start="3">
<li class="leading-relaxed ">监听页面滚动</li>
</ol>
<pre><!--$--><div class="prism-code language-js rounded-md p-4 overflow-x-auto text-sm" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> useSyncExternalStore </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;react&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">subscribe</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">onStoreChange</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  global</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">window</span><span class="whitespace-pre-wrap">?.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">addEventListener</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;scroll&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> onStoreChange</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> global</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">window</span><span class="whitespace-pre-wrap">?.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">removeEventListener</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;scroll&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> onStoreChange</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useScrollY</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">getY</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">id</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> id</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useSyncExternalStore</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    subscribe</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">getY</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">global</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap">window</span><span class="whitespace-pre-wrap">?.</span><span class="whitespace-pre-wrap">scrollY</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">undefined</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useSyncExternalStorePage</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="whitespace-pre-wrap"> scrollY </span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">useScrollY</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">Array</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">length</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">100</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">.</span><span class="whitespace-pre-wrap" style="color:rgb(80, 250, 123)">map</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">(</span><span class="whitespace-pre-wrap">value</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> index</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">=&gt;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        </span><span class="whitespace-pre-wrap" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">p key</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">index</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap">占位符</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">p</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div style</span><span class="whitespace-pre-wrap">=</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">position</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;fixed&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">bottom</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;0px&quot;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">,</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap">right</span><span class="whitespace-pre-wrap">:</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(255, 121, 198)">&quot;0px&quot;</span><span class="whitespace-pre-wrap"> </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">        </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">{</span><span class="whitespace-pre-wrap">scrollY</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">      </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">div</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">    </span><span class="whitespace-pre-wrap">&lt;</span><span class="whitespace-pre-wrap">/</span><span class="whitespace-pre-wrap">&gt;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap">  </span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">)</span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">;</span><span class="whitespace-pre-wrap"></span></div><div class="token-line" style="color:#F8F8F2"><span class="whitespace-pre-wrap"></span><span class="whitespace-pre-wrap" style="color:rgb(248, 248, 242)">}</span><span class="whitespace-pre-wrap"></span></div></div><!--/$--></pre>
<h2 class="mdx-heading text-2xl font-bold whitespace-pre-wrap mt-6 mb-4 group text-header  dark:text-header-dark" id="自定义-hook">自定义 Hook<a href="#自定义-hook" class="hidden pl-2 group-hover:inline-block"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></a></h2>
<h1 class="mdx-heading text-3xl font-extrabold my-6 text-header dark:text-header-dark" id="参考资料">参考资料</h1>
<p class="whitespace-pre-wrap my-2 "><a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html" class="hover:underline text-highlight decoration-2 underline-offset-2 decoration-highlight">https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html</a></p></article><aside class="hidden xl:block fixed top-14 right-0 w-[18rem] py-6 overflow-y-auto"><ul class="text-sm font-medium"><li class="pl-2 text-base">hook</li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#为什么引入-hook" class="block py-1">为什么引入 hook</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usestate" class="block py-1">useState</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#useeffect" class="block py-1">useEffect</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#依赖项" class="block py-1">依赖项</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#useref" class="block py-1">useRef</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-6 text-xs"><a href="#用法" class="block py-1">用法</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usecontext" class="block py-1">useContext</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usememo" class="block py-1">useMemo</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usecallback" class="block py-1">useCallback</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usetransition" class="block py-1">useTransition</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usedeferredvalue" class="block py-1">useDeferredValue</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#usesyncexternalstorepage" class="block py-1">useSyncExternalStorePage</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-4"><a href="#自定义-hook" class="block py-1">自定义 Hook</a></li><li class="border-l hover:text-hover border-slate-900/10 dark:border-slate-300/10 pl-2"><a href="#参考资料" class="block py-1">参考资料</a></li></ul></aside></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"toc":[{"text":"hook","hash":"#hook","depth":1},{"text":"为什么引入 hook","hash":"#为什么引入-hook","depth":2},{"text":"useState","hash":"#usestate","depth":2},{"text":"useEffect","hash":"#useeffect","depth":2},{"text":"依赖项","hash":"#依赖项","depth":3},{"text":"useRef","hash":"#useref","depth":2},{"text":"用法","hash":"#用法","depth":3},{"text":"useContext","hash":"#usecontext","depth":2},{"text":"useMemo","hash":"#usememo","depth":2},{"text":"useCallback","hash":"#usecallback","depth":2},{"text":"useTransition","hash":"#usetransition","depth":2},{"text":"useDeferredValue","hash":"#usedeferredvalue","depth":2},{"text":"useSyncExternalStorePage","hash":"#usesyncexternalstorepage","depth":2},{"text":"自定义 Hook","hash":"#自定义-hook","depth":2},{"text":"参考资料","hash":"#参考资料","depth":1}],"code":"var Component=(()=\u003e{var a=Object.create;var l=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var S=(r,n)=\u003e()=\u003e(n||r((n={exports:{}}).exports,n),n.exports),v=(r,n)=\u003e{for(var t in n)l(r,t,{get:n[t],enumerable:!0})},o=(r,n,t,i)=\u003e{if(n\u0026\u0026typeof n==\"object\"||typeof n==\"function\")for(let c of f(n))!g.call(r,c)\u0026\u0026c!==t\u0026\u0026l(r,c,{get:()=\u003en[c],enumerable:!(i=u(n,c))||i.enumerable});return r};var x=(r,n,t)=\u003e(t=r!=null?a(p(r)):{},o(n||!r||!r.__esModule?l(t,\"default\",{value:r,enumerable:!0}):t,r)),m=r=\u003eo(l({},\"__esModule\",{value:!0}),r);var d=S((k,s)=\u003e{s.exports=_jsx_runtime});var C={};v(C,{default:()=\u003eb});var e=x(d());function h(r){let n=Object.assign({h1:\"h1\",p:\"p\",h2:\"h2\",ul:\"ul\",li:\"li\",code:\"code\",pre:\"pre\",strong:\"strong\",h3:\"h3\",ol:\"ol\",a:\"a\"},r.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h1,{hash:\"hook\",children:\"hook\"}),`\n`,(0,e.jsx)(n.p,{children:\"Hook \\u662F React 16.8 \\u7684\\u65B0\\u589E\\u7279\\u6027\\uFF0C\\u4F7F\\u5F97\\u51FD\\u6570\\u7EC4\\u4EF6\\u4E5F\\u80FD\\u50CF\\u7C7B\\u7EC4\\u4EF6\\u4F7F\\u7528 props \\u548C state \\u7B49\\u7279\\u6027\\u3002\"}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u4E3A\\u4EC0\\u4E48\\u5F15\\u5165-hook\",children:\"\\u4E3A\\u4EC0\\u4E48\\u5F15\\u5165 hook\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u89E3\\u51B3\\u957F\\u65F6\\u95F4\\u4F7F\\u7528\\u548C\\u7EF4\\u62A4 react \\u8FC7\\u7A0B\\u4E2D\\u9047\\u5230\\u7684\\u95EE\\u9898\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u96BE\\u4EE5\\u91CD\\u7528\\u548C\\u5171\\u4EAB\\u7EC4\\u4EF6\\u4E2D\\u7684\\u4E0E\\u72B6\\u6001\\u76F8\\u5173\\u7684\\u903B\\u8F91\\uFF1B\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u903B\\u8F91\\u590D\\u6742\\u7684\\u7EC4\\u4EF6\\u53D8\\u5F97\\u96BE\\u4EE5\\u5F00\\u53D1\\u548C\\u7EF4\\u62A4\\uFF0C\\u5F53\\u6211\\u4EEC\\u7684\\u7EC4\\u4EF6\\u9700\\u8981\\u5904\\u7406\\u4E2A\\u4E0D\\u76F8\\u5173\\u7684\\u591A\\u4E2A local state \\u65F6\\uFF0C\\u6BCF\\u4E2A\\u751F\\u547D\\u5468\\u671F\\u51FD\\u6570\\u4E2D\\u53EF\\u80FD\\u5305\\u542B\\u5404\\u79CD\\u4E92\\u4E0D\\u76F8\\u5173\\u7684\\u903B\\u8F91\\u5728\\u91CC\\u9762\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u7C7B\\u7EC4\\u4EF6\\u7684 this \\u589E\\u52A0\\u5B66\\u4E60\\u6210\\u672C\\uFF0C\\u7C7B\\u7EC4\\u4EF6\\u5728\\u57FA\\u4E8E\\u73B0\\u6709\\u5DE5\\u5177\\u4E0A\\u7684\\u4F18\\u5316\\u5B58\\u5728\\u5B58\\u5728\\u4E9B\\u8BB8\\u95EE\\u9898\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u7531\\u4E8E\\u4E1A\\u52A1\\u6539\\u52A8\\uFF0C\\u51FD\\u6570\\u7EC4\\u4EF6\\u4E0D\\u5F97\\u4E0D\\u6539\\u53D8\\u4E3A\\u7C7B\\u7EC4\\u4EF6\\u7B49\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u56E0\\u6B64\\uFF0C\\u73B0\\u5728\\u7684\\u51FD\\u6570\\u7EC4\\u4EF6\\u4E5F\\u53EF\\u4EE5\\u662F\\u6709\\u72B6\\u6001\\u7684\\u7EC4\\u4EF6\\uFF0C\\u5185\\u90E8\\u4E5F\\u53EF\\u4EE5\\u7EF4\\u62A4\\u81EA\\u8EAB\\u7684\\u72B6\\u6001\\u4EE5\\u53CA\\u505A\\u4E00\\u4E9B\\u903B\\u8F91\\u65B9\\u9762\\u7684\\u5904\\u7406\\u3002\"}),`\n`,(0,e.jsx)(n.h2,{hash:\"usestate\",children:(0,e.jsx)(n.code,{children:\"useState\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4E3A\\u4EC0\\u4E48\\u4E0D\\u8981\\u5728\\u5FAA\\u73AF\\u3001\\u6761\\u4EF6\\u5224\\u65AD\\u6216\\u8005\\u5B50\\u51FD\\u6570\\u4E2D\\u8C03\\u7528 useState?\"}),`\n`,(0,e.jsx)(n.h2,{hash:\"useeffect\",children:(0,e.jsx)(n.code,{children:\"useEffect\"})}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-JS\",children:`useEffect(() =\u003e {\n  // \\u7EC4\\u4EF6\\u6E32\\u67D3\\u540E\\u6267\\u884C\n\n  return () =\u003e {\n    // \\u7EC4\\u4EF6\\u5378\\u8F7D\\u540E\\u6267\\u884C\n  }\n},[])\n`})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsxs)(n.strong,{children:[(0,e.jsx)(n.code,{children:\"useEffect\"}),\" \\u548C \",(0,e.jsx)(n.code,{children:\"useLayoutEffect\"}),\" \\u7684\\u533A\\u522B\"]})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"useEffect\"}),\"\\xA0\\u662F\\u5728 react \",(0,e.jsx)(n.strong,{children:\"\\u5B8C\\u6210\\u7EC4\\u4EF6\\u6E32\\u67D3\\u4E4B\\u540E\"}),\"\\uFF0C \",(0,e.jsx)(n.strong,{children:\"\\u5F02\\u6B65\\u6267\\u884C\"}),\" \\u7684\\uFF0C\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"useLayoutEffect\"}),\"\\xA0\\u662F\\u5728 react \\u628A \",(0,e.jsx)(n.strong,{children:\"\\u7EC4\\u4EF6\\uFF08\\u66F4\\u65B0\\uFF09\\u771F\\u6B63\\u6E32\\u67D3\\u5230\\u754C\\u9762\\u4E4B\\u524D\"}),\"\\uFF0C\",(0,e.jsx)(n.strong,{children:\"\\u540C\\u6B65\\u6267\\u884C\"}),\"\\u7684\\u3002\\u548C\\xA0\",(0,e.jsx)(n.code,{children:\"componentDidMount\"}),\"\\xA0\\u7B49\\u4EF7\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"useInsertionEffect\"})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"useInsertionEffect\"}),\" \\u6267\\u884C\\u65F6\\u673A\\u6BD4 \",(0,e.jsx)(n.code,{children:\"useLayoutEffect\"}),\" \\u8FD8\\u524D\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u672C\\u8D28\\u4E0A \",(0,e.jsx)(n.code,{children:\"useInsertionEffect\"}),\" \\u4E3B\\u8981\\u662F\\u89E3\\u51B3 CSS-in-JS \\u5728\\u6E32\\u67D3\\u4E2D\\u6CE8\\u5165\\u6837\\u5F0F\\u7684\\u6027\\u80FD\\u95EE\\u9898\\u3002\\u8FD9\\u4E2A hooks \\u4E3B\\u8981\\u662F\\u5E94\\u7528\\u4E8E\\u8FD9\\u4E2A\\u573A\\u666F\\uFF0C\\u5728\\u5176\\u4ED6\\u573A\\u666F\\u4E0B React \\u4E0D\\u671F\\u671B\\u7528\\u8FD9\\u4E2A hooks \\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u4F9D\\u8D56\\u9879\",children:\"\\u4F9D\\u8D56\\u9879\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\" \"}),\" \\u7A7A\\u503C\\uFF1A\\u4E0D\\u4F20\\u9012\\u4F9D\\u8D56\\u9879\\u6570\\u7EC4\\u5C06\\u5728\\u6BCF\\u6B21 DOM \\u66F4\\u65B0\\u65F6\\u8FD0\\u884C\\u56DE\\u8C03\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"[]\"}),\": \\u9996\\u6B21\\u6E32\\u67D3\\u65F6\\u6267\\u884C\\uFF0C\\u540E\\u7EED\\u66F4\\u65B0\\u4E0D\\u6267\\u884C\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"[dep1, dep2,...]\"}),\": \\u4F9D\\u8D56\\u9879\\u6D45\\u6BD4\\u8F83\\uFF0C\\u65B0\\u65E7\\u4E0D\\u4E00\\u81F4\\u65F6\\u6267\\u884C\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.h2,{hash:\"useref\",children:(0,e.jsx)(n.code,{children:\"useRef\"})}),`\n`,(0,e.jsx)(n.h3,{hash:\"\\u7528\\u6CD5\",children:\"\\u7528\\u6CD5\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u4FDD\\u5B58\\u771F\\u5B9E dom \\u8282\\u70B9\\u7684\\u5F15\\u7528\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"ref.current\"}),\"\\u5C5E\\u6027\\u8BBF\\u95EE\\u8FD9\\u4E2A\\xA0\",(0,e.jsx)(n.code,{children:\"ref\"}),\"\\u7684\\u5F53\\u524D\\u53D8\\u91CF\\uFF0C\\u8FD9\\u4E2A\\u53D8\\u91CF\\u662F\\u6709\\u610F\\u8BBE\\u7F6E\\u4E3A\\u53EF\\u53D8\\u7684\\u3002\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u4E3A\\u4EC0\\u4E48\\u53EA\\u8981\\u628A\",(0,e.jsx)(n.code,{children:\"ref\"}),`\\u6302\\u5230\\u67D0\\u4E2Areact\\u5143\\u7D20\\u4E0A\\uFF0C\\u5C31\\u53EF\\u4EE5\\u62FF\\u5230\\u5B83\\u7684dom\\uFF1F\n\\u6E90\\u7801\\u662F\\u5982\\u4F55\\u5C06 dom \\u8282\\u70B9\\u6302\\u5230 ref.current \\u4E0A\\u7684\\uFF1F`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-JS\",children:`function TextInputWithFocusButton() {\n  const inputEl = useRef(null);\n  const onButtonClick = () =\u003e {\n    // \\`current\\` \\u6307\\u5411\\u5DF2\\u6302\\u8F7D\\u5230 DOM \\u4E0A\\u7684\\u6587\\u672C\\u8F93\\u5165\\u5143\\u7D20\n    inputEl.current.focus();\n  };\n  return (\n    \u003c\u003e\n      \u003cinput ref={inputEl} type=\"text\" /\u003e\n      \u003cbutton onClick={onButtonClick}\u003eFocus the input\u003c/button\u003e\n    \u003c/\u003e\n  );\n}\n\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"2.\\u5B58\\u53D8\\u91CF\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function Timer() {\n  const intervalRef = useRef();\n\n  useEffect(() =\u003e {\n    const id = setInterval(() =\u003e {\n      // ...\n    });\n    intervalRef.current = id;\n    return () =\u003e {\n      clearInterval(intervalRef.current);\n    };\n  });\n\n  // ...\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u5C06 current \\u663E\\u793A\\u5230\\u7EC4\\u4EF6\\u4E0A\\uFF0C\\u53EA\\u53D8\\u66F4 current \\u7684\\u503C\\u4E0D\\u4F1A\\u89E6\\u53D1\\u91CD\\u65B0\\u6E32\\u67D3\\uFF0C\\u5373 current \\u88AB\\u4FEE\\u6539\\u4E86\\u503C\\uFF0C\\u663E\\u793A\\u7684\\u5185\\u5BB9\\u4F9D\\u7136\\u4F1A\\u662F\\u65E7\\u6570\\u636E\\u3002\\u53EA\\u5728\\u89E6\\u53D1\\u91CD\\u65B0\\u6E32\\u67D3\\uFF08state,prop\\u53D8\\u66F4)\\u65F6\\u88AB\\u7EC4\\u4EF6\\u663E\\u793A\\u5185\\u5BB9\\u624D\\u4F1A\\u88AB\\u5237\\u65B0\\u3002\"}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"createRef\"}),\" \\u548C \",(0,e.jsx)(n.code,{children:\"useRef\"})]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"createRef \\u6BCF\\u6B21\\u6E32\\u67D3\\u90FD\\u4F1A\\u8FD4\\u56DE\\u4E00\\u4E2A\\u65B0\\u7684\\u5F15\\u7528\\uFF0C\\u800C useRef \\u6BCF\\u6B21\\u90FD\\u4F1A\\u8FD4\\u56DE\\u76F8\\u540C\\u7684\\u5F15\\u7528\\u3002\"})}),`\n`,(0,e.jsx)(n.p,{children:\"createRef \\u53EF\\u4EE5\\u5728\\u7C7B\\u7EC4\\u4EF6\\u4E2D\\u4F7F\\u7528\\uFF0CuseRef \\u53EA\\u80FD\\u5728\\u51FD\\u6570\\u7EC4\\u4EF6\\u4E2D\\u4F7F\\u7528\\u3002\"}),`\n`,(0,e.jsx)(n.h2,{hash:\"usecontext\",children:\"useContext\"}),`\n`,(0,e.jsxs)(n.p,{children:[`\\u7528\\u4E8E\\u8DE8\\u7EC4\\u4EF6\\uFF08\\u7236\\u5B50\\u5B59\\uFF09\\u4F20\\u503C\\u7684\\u4E00\\u79CD\\u65B9\\u5F0F\\u3002\n\\u5D4C\\u5957\\u4F7F\\u7528 `,(0,e.jsx)(n.code,{children:\"useContext\"}),\"\\uFF0C\\u67E5\\u627E key \\u503C\\u7684\\u65B9\\u5F0F\\u5E94\\u8BE5\\u662F\\u5C31\\u8FD1\\u539F\\u5219\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-JS\",children:`import React, { createContext, useContext } from \"react\";\n\nconst context = createContext();\n\nexport default function index() {\n  return (\n    \u003cdiv\u003e\n      \u003ch3\u003eContext test\u003c/h3\u003e\n      \u003ccontext.Provider value={{ value: 1 }}\u003e\n        \u003cChild1 /\u003e\n      \u003c/context.Provider\u003e\n    \u003c/div\u003e\n  );\n}\n\nfunction Child1() {\n  const { value } = useContext(context);\n  return (\n    \u003cdiv\u003e\n      child1:{value}\n      \u003cChild2 /\u003e\n    \u003c/div\u003e\n  );\n}\n\nfunction Child2() {\n  return (\n    \u003ccontext.Provider value={{ value: 3 }}\u003e\n      \u003cChild3 /\u003e\n    \u003c/context.Provider\u003e\n  );\n}\n\nfunction Child3() {\n  const { value } = useContext(context);\n  return \u003cdiv\u003echild3:{value}\u003c/div\u003e;\n}\n\n// Context test\n// child1:1\n// child3:3\n\n`})}),`\n`,(0,e.jsx)(n.h2,{hash:\"usememo\",children:\"useMemo\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u7F13\\u5B58\\u9700\\u8981\\u7ECF\\u8FC7\\u5927\\u91CF\\u8BA1\\u7B97\\u7684\\u503C\\uFF0C\\u907F\\u514D\\u53D8\\u91CF\\u4F5C\\u4E3A \",(0,e.jsx)(n.code,{children:\"prop\"}),\" \\u65F6\\u91CD\\u65B0\\u8D4B\\u503C\\u5BFC\\u81F4\\u5B50\\u7EC4\\u4EF6\\u53D1\\u751F\\u591A\\u4F59\\u7684\\u91CD\\u65B0\\u6E32\\u67D3\"]}),`\n`,(0,e.jsx)(n.h2,{hash:\"usecallback\",children:\"useCallback\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u7F13\\u5B58\\u51FD\\u6570\\u5730\\u5740\\uFF0C\\u907F\\u514D\\u51FD\\u6570\\u4F5C\\u4E3A \",(0,e.jsx)(n.code,{children:\"prop\"}),\" \\u65F6\\u91CD\\u65B0\\u8D4B\\u503C\\u5BFC\\u81F4\\u5B50\\u7EC4\\u4EF6\\u53D1\\u751F\\u591A\\u4F59\\u7684\\u91CD\\u65B0\\u6E32\\u67D3\"]}),`\n`,(0,e.jsx)(n.h2,{hash:\"usetransition\",children:\"useTransition\"}),`\n`,(0,e.jsx)(n.p,{children:\"react 18 \\u628A update \\u5206\\u4E3A\\u4E24\\u79CD\\u7C7B\\u578B\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Urgent updates\"}),\"\\xA0\\u7D27\\u6025\\u66F4\\u65B0\\uFF0C\\u6307\\u76F4\\u63A5\\u4EA4\\u4E92\\uFF0C\\u901A\\u5E38\\u6307\\u7684\\u7528\\u6237\\u4EA4\\u4E92\\u3002\\u5982\\u70B9\\u51FB\\u3001\\u8F93\\u5165\\u7B49\\u3002\\u8FD9\\u79CD\\u66F4\\u65B0\\u4E00\\u65E6\\u4E0D\\u53CA\\u65F6\\uFF0C\\u7528\\u6237\\u5C31\\u4F1A\\u89C9\\u5F97\\u54EA\\u91CC\\u4E0D\\u5BF9\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Transition updates\"}),\"\\xA0\\u8FC7\\u6E21\\u66F4\\u65B0\\uFF0C\\u5982UI\\u4ECE\\u4E00\\u4E2A\\u89C6\\u56FE\\u5411\\u53E6\\u4E00\\u4E2A\\u89C6\\u56FE\\u7684\\u66F4\\u65B0\\u3002\\u901A\\u5E38\\u8FD9\\u79CD\\u66F4\\u65B0\\u7528\\u6237\\u5E76\\u4E0D\\u7740\\u6025\\u770B\\u5230\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function TransitionPage() {\n  const [isPending, setStartTransition] = useTransition();\n  return (\n    \u003cdiv\u003e\n      \u003ch3\u003eTransitionPage\u003c/h3\u003e\n\n      \u003cbutton\n        disabled={isPending}\n        onClick={() =\u003e setStartTransition(() =\u003e setresource(fetchData()))}\n      \u003e\n        click\n      \u003c/button\u003e\n    \u003c/div\u003e\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.h2,{hash:\"usedeferredvalue\",children:\"useDeferredValue\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5EF6\\u8FDF\\u66F4\\u65B0 UI \\u7684\\u67D0\\u4E9B\\u90E8\\u5206\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4F7F\\u7528 query \\u7684\\u7EC4\\u4EF6\\u66F4\\u65B0\\u4F18\\u5148\\u6E32\\u67D3\\uFF0C\\u4F7F\\u7528 deferredQuery \\u7684\\u7EC4\\u4EF6\\u66F4\\u65B0\\u5EF6\\u8FDF\\u6E32\\u67D3\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`import { useState, useDeferredValue } from 'react';\n\nfunction SearchPage() {\n  const [query, setQuery] = useState('');\n  const deferredQuery = useDeferredValue(query);\n  // ...\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u7ED3\\u5408 suspend \\u7EC4\\u4EF6\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-jsx\",children:`import { Suspense, useState, useDeferredValue } from 'react';\nimport SearchResults from './SearchResults.js';\n\nexport default function App() {\n  const [query, setQuery] = useState('');\n  const deferredQuery = useDeferredValue(query);\n  // isStale \\u8868\\u793A\\u5F53\\u524D\\u663E\\u793A\\u7684\\u5185\\u5BB9\\u662F\\u5426\\u8FC7\\u65F6\n  const isStale = query !== deferredQuery;\n  return (\n    \u003c\u003e\n      \u003clabel\u003e\n        Search albums:\n        \u003cinput value={query} onChange={e =\u003e setQuery(e.target.value)} /\u003e\n      \u003c/label\u003e\n      \u003cSuspense fallback={\u003ch2\u003eLoading...\u003c/h2\u003e}\u003e\n        \u003cdiv style={{\n          opacity: isStale ? 0.5 : 1,\n          transition: isStale ? 'opacity 0.2s 0.2s linear' : 'opacity 0s 0s linear'\n        }}\u003e\n          \u003cSearchResults query={deferredQuery} /\u003e\n        \u003c/div\u003e\n      \u003c/Suspense\u003e\n    \u003c/\u003e\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.h2,{hash:\"usesyncexternalstorepage\",children:\"useSyncExternalStorePage\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u8BA2\\u9605\\u5916\\u90E8\\u6570\\u636E\\u6E90\\uFF08store\\u3001\\u4E8B\\u4EF6\\uFF09\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u76D1\\u542C\\u7F51\\u7EDC\\u5728\\u7EBF\"}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function subscrbe(callback) {\n  window.addEventListener(\"online\", callback);\n  window.addEventListener(\"offline\", callback);\n  return () =\u003e {\n    window.removeEventListener(\"online\", callback);\n    window.removeEventListener(\"offline\", callback);\n  };\n}\n\nfunction useOnlineStatus() {\n  return useSyncExternalStore(\n    subscrbe,\n    () =\u003e navigator.onLine,\n    () =\u003e true\n  );\n}\n\nexport default function UseSyncExternalStorePage() {\n  const isOnline = useOnlineStatus();\n  // console.log(\"isOnline\", isOnline);\n  return \u003cdiv\u003eisOnline:{isOnline.toString()}\u003c/div\u003e;\n}\n\n`})}),`\n`,(0,e.jsxs)(n.ol,{start:\"2\",children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u76D1\\u542C\\u8DEF\\u7531\\u53D8\\u66F4\"}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function useHistorySelector(selector) {\n  const history = useHistory();\n  return useSyncExternalStore(history.listen, () =\u003e selector(history));\n}\n`})}),`\n`,(0,e.jsxs)(n.ol,{start:\"3\",children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u76D1\\u542C\\u9875\\u9762\\u6EDA\\u52A8\"}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`import { useSyncExternalStore } from \"react\";\n\nfunction subscribe(onStoreChange) {\n  global.window?.addEventListener(\"scroll\", onStoreChange);\n  return () =\u003e global.window?.removeEventListener(\"scroll\", onStoreChange);\n}\nfunction useScrollY(getY = (id) =\u003e id) {\n  return useSyncExternalStore(\n    subscribe,\n    () =\u003e getY(global.window?.scrollY),\n    () =\u003e undefined\n  );\n}\n\nexport default function useSyncExternalStorePage() {\n  const scrollY = useScrollY();\n\n  return (\n    \u003c\u003e\n      {Array.from({ length: 100 }).map((value, index) =\u003e {\n        return \u003cp key={index}\u003e\\u5360\\u4F4D\\u7B26\u003c/p\u003e;\n      })}\n      \u003cdiv style={{ position: \"fixed\", bottom: \"0px\", right: \"0px\" }}\u003e\n        \u003cdiv\u003e{scrollY}\u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/\u003e\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.h2,{hash:\"\\u81EA\\u5B9A\\u4E49-hook\",children:\"\\u81EA\\u5B9A\\u4E49 Hook\"}),`\n`,(0,e.jsx)(n.h1,{hash:\"\\u53C2\\u8003\\u8D44\\u6599\",children:\"\\u53C2\\u8003\\u8D44\\u6599\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html\",children:\"https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html\"})})]})}function y(r={}){let{wrapper:n}=r.components||{};return n?(0,e.jsx)(n,Object.assign({},r,{children:(0,e.jsx)(h,r)})):h(r)}var b=y;return m(C);})();\n;return Component;"},"__N_SSG":true},"page":"/[[...id]]","query":{"id":["react","hook"]},"buildId":"tm4WpqTZk4RfqfoaAvJmO","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>